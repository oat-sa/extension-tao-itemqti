define("taoQtiItem/controller/routes",[],function(){return{QtiPreview:{actions:{index:"taoItems/controller/preview/itemRunner"}},QtiCreator:{actions:{index:"controller/creator/main"}}}}),function(e){function t(){try{return s in e&&e[s]}catch(t){return!1}}function i(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(r),l.appendChild(r),r.addBehavior("#default#userData"),r.load(s);var i=e.apply(o,t);return l.removeChild(r),i}}function n(e){return e.replace(h,"___")}var r,o={},a=e.document,s="localStorage",c="script";if(o.disabled=!1,o.set=function(){},o.get=function(){},o.remove=function(){},o.clear=function(){},o.transact=function(e,t,i){var n=o.get(e);null==i&&(i=t,t=null),"undefined"==typeof n&&(n=t||{}),i(n),o.set(e,n)},o.getAll=function(){},o.forEach=function(){},o.serialize=function(e){return JSON.stringify(e)},o.deserialize=function(e){if("string"!=typeof e)return void 0;try{return JSON.parse(e)}catch(t){return e||void 0}},t())r=e[s],o.set=function(e,t){return void 0===t?o.remove(e):(r.setItem(e,o.serialize(t)),t)},o.get=function(e){return o.deserialize(r.getItem(e))},o.remove=function(e){r.removeItem(e)},o.clear=function(){r.clear()},o.getAll=function(){var e={};return o.forEach(function(t,i){e[t]=i}),e},o.forEach=function(e){for(var t=0;t<r.length;t++){var i=r.key(t);e(i,o.get(i))}};else if(a.documentElement.addBehavior){var l,d;try{d=new ActiveXObject("htmlfile"),d.open(),d.write("<"+c+">document.w=window</"+c+'><iframe src="/favicon.ico"></iframe>'),d.close(),l=d.w.frames[0].document,r=l.createElement("div")}catch(u){r=a.createElement("div"),l=a.body}var h=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");o.set=i(function(e,t,i){return t=n(t),void 0===i?o.remove(t):(e.setAttribute(t,o.serialize(i)),e.save(s),i)}),o.get=i(function(e,t){return t=n(t),o.deserialize(e.getAttribute(t))}),o.remove=i(function(e,t){t=n(t),e.removeAttribute(t),e.save(s)}),o.clear=i(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(s);for(var i,n=0;i=t[n];n++)e.removeAttribute(i.name);e.save(s)}),o.getAll=function(){var e={};return o.forEach(function(t,i){e[t]=i}),e},o.forEach=i(function(e,t){for(var i,n=e.XMLDocument.documentElement.attributes,r=0;i=n[r];++r)t(i.name,o.deserialize(e.getAttribute(i.name)))})}try{var f="__storejs__";o.set(f,f),o.get(f)!=f&&(o.disabled=!0),o.remove(f)}catch(u){o.disabled=!0}o.enabled=!o.disabled,"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define("store",o):e.store=o}(this.window||global),define("taoQtiItem/qtiCreator/editor/base",["jquery","store","jqueryui"],function(e,t){"use strict";var i=function(){var i={scope:e("#item-editor-scope"),toolbar:e("#item-editor-toolbar"),sidebars:e(".item-editor-sidebar"),interactionBar:e("#item-editor-interaction-bar"),itemWidgetBar:e("#item-editor-item-widget-bar"),itemBar:e("#item-editor-item-bar"),widgetBar:e("#item-editor-widget-bar"),itemPanel:e("#item-editor-panel"),items:e(".item-editor-item"),overlay:e("#item-editor-overlay"),widget:e(),block:e()},n=function(){var t=0;i.sidebars.add(i.itemPanel).each(function(){t=Math.max(e(this).height(),t)}).height(t)};n();var r=function(){i.item=e(".item-editor-item:visible"),i.dropArea=i.item.find(".item-editor-drop-area")},o=function(){return i.item};r();var a=function(e){i.widget=e},s=function(){return i.widget},c=function(e){i.block=e},l=function(){return i.block},d={width:i.itemPanel.width()-parseInt(i.item.css("border-left"),10)-parseInt(i.item.css("border-right"),10),minWidth:768,maxWidth:1200},u=function(){return{set:function(){var i=e.extend({},d,t.get("item-editor"));return 1===arguments.length&&e.isPlainObject(arguments[0])?i=e.extend({},i,arguments[0]):i[arguments[0]]=arguments[1],t.set("item-editor",i)},getAll:function(){return e.extend({},d,t.get("item-editor"))},get:function(e){var t=this.getAll();return t[e]||null}}}();return e.extend(i,{setup:u,setActiveItem:r,getActiveItem:o,setActiveWidget:a,getActiveWidget:s,setActiveBlock:c,getActiveBlock:l,adaptColumnHeight:n})}();return i}),define("text",["module"],function(e){var t,i,n,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,d=l&&location.protocol&&location.protocol.replace(/\:/,""),u=l&&location.hostname,h=l&&(location.port||void 0),f={},m=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];try{e=new ActiveXObject(i)}catch(n){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),i=e.substring(o+1,e.length)):t=e,n=i||t,o=n.indexOf("!"),-1!==o&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,r){var o,a,s,c=t.xdRegExp.exec(e);return c?(o=c[2],a=c[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==i||a&&a.toLowerCase()!==n.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(e,i,n,r){n=i?t.strip(n):n,m.isBuild&&(f[e]=n),r(n)},load:function(e,i,n,r){if(r.isBuild&&!r.inlineText)return void n();m.isBuild=r.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(a),c=m.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void n():void(!l||c(s,d,u,h)?t.get(s,function(i){t.finishLoad(e,o.strip,i,n)},function(e){n.error&&n.error(e)}):i([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)}))},write:function(e,i,n){if(f.hasOwnProperty(i)){var r=t.jsEscape(f[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,r,o){var a=t.parseName(i),s=a.ext?"."+a.ext:"",c=a.moduleName+s,l=n.toUrl(a.moduleName+s)+".js";t.load(c,n,function(){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},t.write(e,c,i,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var r=i.readFileSync(e,"utf8");0===r.indexOf("﻿")&&(r=r.substring(1)),t(r)}catch(o){n(o)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,i,n,r){var o,a=t.createXhr();if(a.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);m.onXhr&&m.onXhr(a,e),a.onreadystatechange=function(){var t,r;4===a.readyState&&(t=a.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=a,n(r)):i(a.responseText),m.onXhrComplete&&m.onXhrComplete(a,e))},a.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,r="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),c="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(a),i.append(n);c=String(i.toString())}finally{s.close()}t(c)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,a,s,c={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(s,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),c),a.close(),i.close(),t(c.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("json",["text"],function(text){function cacheBust(e){return e=e.replace(CACHE_BUST_FLAG,""),e+=e.indexOf("?")<0?"?":"&",e+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",jsonParse="undefined"!=typeof JSON&&"function"==typeof JSON.parse?JSON.parse:function(val){return eval("("+val+")")},buildMap={};return{load:function(e,t,i,n){!n.isBuild||n.inlineJSON!==!1&&-1===e.indexOf(CACHE_BUST_QUERY_PARAM+"=")?text.get(t.toUrl(e),function(t){n.isBuild?(buildMap[e]=t,i(t)):i(jsonParse(t))},i.error,{accept:"application/json"}):i(null)},normalize:function(e,t){return-1!==e.indexOf(CACHE_BUST_FLAG)&&(e=cacheBust(e)),t(e)},write:function(e,t,i){if(t in buildMap){var n=buildMap[t];i('define("'+e+"!"+t+'", function(){ return '+n+";});\n")}}}}),define("json!taoQtiItem/qtiCreator/editor/resources/device-list.json",function(){return{tablets:{"62fa6f280e436fa3d8f9db12c9141101":{label:"Amazon Kindle Fire",width:1024,height:600,scaleFactor:1,dpWidth:1024,dpHeight:600},"7b5d396c19dca753a26f1adaaeb4fd11":{label:"Amazon Kindle Fire HD 7",width:1280,height:800,scaleFactor:1.5,dpWidth:853,dpHeight:1200},"6c9b20b2493025a5b82bb144393edb16":{label:"Amazon Kindle Fire HD 8.9",width:1920,height:1200,scaleFactor:1.5,dpWidth:1280,dpHeight:1800},"6f365c990d35e74411343eb05313ca43":{label:"Apple iPad 1 / 2 / iPad Mini",width:1024,height:768,scaleFactor:1,dpWidth:1024,dpHeight:768},"5b01dd2805045334381ee966230fcae9":{label:"Apple iPad 3 / 4",width:2048,height:1536,scaleFactor:2,dpWidth:1024,dpHeight:3072},"78fcfa10415d5513c276b7c31e0e7e16":{label:"BlackBerry PlayBook",width:1024,height:600,scaleFactor:1,dpWidth:1024,dpHeight:600},c9532d26bce34f2fe42433c38462ec66:{label:"Google Nexus 10",width:2560,height:1600,scaleFactor:2,dpWidth:1280,dpHeight:3200},"2ad727fc8fa3a4f2a62a6158fc71f84a":{label:"Google Nexus 7",width:1280,height:800,scaleFactor:1.325,dpWidth:966,dpHeight:1060},"401f105a9b42168c449f3ddb101ca64b":{label:"Google Nexus 7 2",width:1920,height:1200,scaleFactor:2,dpWidth:960,dpHeight:2400},"66f8f53a350ffa65d7c260fde2b1278e":{label:"Motorola Xoom, Xyboard",width:1280,height:800,scaleFactor:1,dpWidth:1280,dpHeight:800},"1cdb10bcaa01a045e272132656a8d807":{label:"Samsung Galaxy Tab",width:1024,height:600,scaleFactor:1,dpWidth:1024,dpHeight:600},"8c9a75438e8f2c7e8c02fd9df4ffd590":{label:"Samsung Galaxy Tab 7.7, 8.9, 10.1",width:1280,height:800,scaleFactor:1,dpWidth:1280,dpHeight:800}},phones:{"1b89338531ef0155c8d6abc2ac02c81a":{label:"Apple iPhone 3GS",width:320,height:480,scaleFactor:1,dpWidth:320,dpHeight:480},"3f89da99d84214cde7df87ebe0699a6f":{label:"Apple iPhone 4",width:640,height:960,scaleFactor:2,dpWidth:320,dpHeight:1920},"0d36971a5b98b367f54ced708c9af849":{label:"Apple iPhone 5",width:640,height:1136,scaleFactor:2,dpWidth:320,dpHeight:2272},"026beffcc051af995660ebdede986ace":{label:"BlackBerry Z10",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},fd2dd53e667d6d49e4fa73356fa941dd:{label:"BlackBerry Z30",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"707584c1ae17d9b5b2cbe8603c91c147":{label:"Google Nexus 4",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},"91823264de952e7f2347e07db5c4058b":{label:"Google Nexus 5",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},cd69817a6e147e8a4677389e56fcf568:{label:"Google Nexus S",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"75994faa6a38e31e99b53fcd75534a33":{label:"HTC Evo, Touch HD, Desire HD, Desire",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"0cab4dfccdfc880687cb608cfe4159db":{label:"HTC One X, EVO LTE",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},c4ff41fcba24d74fc21dc3490ca1edc9:{label:"HTC Sensation, Evo 3D",width:540,height:960,scaleFactor:1.5,dpWidth:360,dpHeight:1440},fa969a5e0dd2de53700eeee4ba4ba142:{label:"LG Optimus 2X, Optimus 3D, Optimus Black",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"33c4f9364e295ec03531f3a3425819cf":{label:"LG Optimus G",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},bc47f5275f0efd56fee52d43a8082981:{label:"LG Optimus LTE, Optimus 4X HD",width:720,height:1280,scaleFactor:1.7,dpWidth:424,dpHeight:2176},"0732887e6e324fd10777b735520a34cf":{label:"LG Optimus One",width:320,height:480,scaleFactor:1.5,dpWidth:213,dpHeight:720},"2e38a78364f09d0da0e9e1a3a68e7fb0":{label:"Motorola Defy, Droid, Droid X, Milestone",width:480,height:854,scaleFactor:1.5,dpWidth:320,dpHeight:1281},bd4b78dddc7c9625a4141a1b1ddabb87:{label:"Motorola Droid 3, Droid 4, Droid Razr, Atrix 4G, Atrix 2",width:540,height:960,scaleFactor:1,dpWidth:540,dpHeight:960},"3bf1edf21cfa81006183d2b02974c84e":{label:"Motorola Droid Razr HD",width:720,height:1280,scaleFactor:1,dpWidth:720,dpHeight:1280},ab5a352e0e016b97dac986f06c394f55:{label:"Nokia C5, C6, C7, N97, N8, X7",width:360,height:640,scaleFactor:1,dpWidth:360,dpHeight:640},"4826fb7d7257aeaac992ce699df41b3c":{label:"Nokia Lumia 7X0, Lumia 8XX, Lumia 900, N800, N810, N900",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"0a691ab20add7c432200f8fa6527b488":{label:"Samsung Galaxy Note",width:800,height:1280,scaleFactor:2,dpWidth:400,dpHeight:2560},"9c23ee31be29960fbac9e9bbfc2fc7b0":{label:"Samsung Galaxy Note 3",width:1080,height:1920,scaleFactor:2,dpWidth:540,dpHeight:3840},"92177c0508c1d73905a58e2338f2a81f":{label:"Samsung Galaxy Note II",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"5222b8866dc4cc606725e16ffcc0a783":{label:"Samsung Galaxy S III, Galaxy Nexus",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"37c1541e2bd55cfd0f4073b0ccdf68b3":{label:"Samsung Galaxy S, S II, W",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"2f7f64b7dda0144907ff300e83eed465":{label:"Samsung Galaxy S4",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},"9c24f9057744dad56043702a9703127f":{label:"Sony Xperia S, Ion",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"0a8b2732a016a9395c3af5f12dd9c0da":{label:"Sony Xperia Sola, U",width:480,height:854,scaleFactor:1,dpWidth:480,dpHeight:854},"5a153d7f53d82dcb0801f041574a6a43":{label:"Sony Xperia Z, Z1",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760}},screens:{"9e523ae15b61dc766f5c818726881ecf":{label:"1920 × 1080",width:1920,height:1080,dpWidth:1920,dpHeight:1080,scaleFactor:1},"07769cd8d0a7d09818b2f0b018042fb7":{label:"1366 × 768",width:1366,height:768,dpWidth:1366,dpHeight:768,scaleFactor:1},"72d5478a24194f98b9378e8e0fd65737":{label:"1280 × 1024",width:1280,height:1024,dpWidth:1280,dpHeight:1024,scaleFactor:1},b7a6dd5900cc72e61f0d3479c7e314ec:{label:"1280 × 800",width:1280,height:800,dpWidth:1280,dpHeight:800,scaleFactor:1},"43193b0ff671a37d8232ab664190a125":{label:"1024 × 768",width:1024,height:768,dpWidth:1024,dpHeight:768,scaleFactor:1},c29e48814af5443ff5688d9e967ce917:{label:"800 × 600",width:800,height:600,dpWidth:800,dpHeight:600,scaleFactor:1}}}}),define("taoQtiItem/qtiCreator/editor/preview",["jquery","store","i18n","taoQtiItem/qtiCreator/editor/base","json!taoQtiItem/qtiCreator/editor/resources/device-list.json","select2"],function(e,t,i,n,r){"use strict";var o,a,s=function(){if(o&&o.length)return!1;var n=function(t){t=e(t);var i=t.contents().find("body"),n=t.contents().find("head");i.addClass("preview-iframe-body"),i.width(200),i.height(200),e('link[rel="stylesheet"]').each(function(){(this.href.indexOf("item-creator")>-1||this.href.indexOf("tao-main-style")>-1)&&n.append(e("<link>",{rel:"stylesheet",href:this.href}))}),n.append('<meta charset="utf-8"/>'),n.append('<meta http-equiv="X-UA-Compatible" content="IE=edge"/>'),n.append("<title>Preview</title>"),i.append(e('<div id="wrapper"/>'))},s=function(){var e=function(e){return"mobile-preview-"+e},i=function(){return"landscape"===t.get("orientation")?"landscape":"portrait"};return{getOrientation:i,orientationToClass:e}}(),c=function(t,i){var n=i?"lft "+i+"-only":"lft";return e("<li>",{"class":n}).append(t)},l=function(i){{var n,o,a,s=t.get("current-"+i+"-device")||"",c=e("<select>",{"class":i+"-device-selector"});e("."+i+"-preview-container")}switch(i){case"mobile":o=r.tablets;break;case"desktop":o=r.screens}for(n in o)o.hasOwnProperty(n)&&(a=e("<option>",{value:[o[n].dpWidth,o[n].dpHeight].join(","),text:o[n].label}),s===o[n].label&&a.prop("selected",!0),c.append(a));return c},d=function(){var n,r,o=e("<select>",{"class":"mobile-orientation-selector"}),a={landscape:i("Landscape"),portrait:i("Portrait")},s=t.get("preview-orientation")||"landscape";for(n in a)a.hasOwnProperty(n)&&(r=e("<option>",{value:n,text:a[n]}),s===n&&r.prop("selected",!0),o.append(r));return o},u=function(i){var n=e("."+i+"-device-selector"),r=e("."+i+"-preview-frame");n.on("change",function(){for(var n,o=e(this),c=o.val().split(","),l=o.find("option:selected").text(),d=c.length;d--;)c[d]=parseFloat(c[d]);return n="mobile"===i&&"portrait"===s.getOrientation()?{width:c[1],height:c[0]}:{width:c[0],height:c[1]},n.width===a.width()&&n.height===a.height()?!1:void r.animate(n,function(){t.set(i+"-device-selector",l)})}),n.select2({minimumResultsForSearch:-1}),n.trigger("change")},h=function(i,n){i.on("change",function(){var i,r=e(this).val(),o=s.getOrientation(),a=e(".preview-mobile-frame");return r===o?!1:(i={height:n.width(),width:n.height()},void n.animate(i,function(){a.removeClass(s.orientationToClass(s.getOrientation())).addClass(s.orientationToClass(r)),t.set("orientation",r)}))}),i.select2({minimumResultsForSearch:-1}),i.trigger("change")},f=function(){return e("<div>",{"class":"feedback lft",html:'<span class="icon-info"/>'+i("Final rendering may differ from this preview!")})},m=function(t){var i=e("<div>",{"class":t+"-preview-frame "+t+"-only preview-outer-frame"}),n=e("<div>",{"class":t+"-preview-container"}),r=e("<div>",{"class":t+"-preview-iframe-container"}),o=e("<iframe>",{"class":"preview-iframe"});return"mobile"===t&&i.addClass(s.orientationToClass(s.getOrientation())),r.append(o),n.append(r),i.append(n),i},p=function(n){var r,a,s,c;return"mobile"===n?(a=i("Desktop preview"),s="desktop",c="icon-screen"):(a=i("Mobile preview"),s="mobile",c="icon-tablet"),r=e("<span>",{"class":"btn-info toggle-view small",html:'<span class="'+c+'"/>'+a}).prop("target",s),r.on("click",function(){var i=e(this).prop("target"),n="preview-"+i,r="preview-desktop"===n?"preview-mobile":"preview-desktop";o.removeClass(r).addClass(n),t.set("preview-type",i)}),r},g=function(){var t=e("<span>",{"class":"btn-info small",html:'Close <span class="icon-close r"/>'});return t.on("click",function(){o.fadeOut()}),t},v=function(){var i=t.get("preview-type")||"desktop",r=["mobile","desktop"],s=r.length,v={},b=e("<form>",{"class":"preview-utility-bar plain",autocomplete:"off"}),I=e("<div>",{"class":"preview-utility-bar-inner"}),y=e("<div>",{"class":"preview-canvas"}),C=f(),w={},q=d(),x={},k=e("<ul>",{"class":"plain rgt clearfix"}),Q=g();for(o=e("<div>",{"class":"preview-overlay tao-scope overlay preview-"+i}),a=e("<div>",{"class":"preview-container"});s--;)v[r[s]]=m(r[s]),x[r[s]]=p(r[s]),w[r[s]]=l(r[s]);k.append(c(w.desktop,"desktop")),k.append(c(x.desktop,"desktop")),k.append(c(w.mobile,"mobile")),k.append(c(q,"mobile")),k.append(c(x.mobile,"mobile")),k.append(c(Q,!1)),I.append(C),I.append(k),b.append(I),y.append(b),y.append(v.desktop),y.append(v.mobile),a.append(y),o.append(a),u("mobile"),u("desktop"),h(q,v.mobile),e(document.body).append(o),o.find("iframe").load(function(){n(this)}),o.hide(),e(document).keyup(function(e){27==e.keyCode&&Q.trigger("click")})};v()},c=function(e){var t=(function(e){var t=e(".desktop-width-slider"),i=e(".desktop-preview-frame"),n=i.find(".desktop-preview-container"),r=function(e){e&&(e=parseInt(e,10),n.width(e))},o=function(){var e={min:798,max:1800,value:n.width(),slide:function(e,t){r(t.value)},start:function(e,t){r(t.value)},stop:function(){},change:function(){}};t.slider(e),r(e.value)};return{init:o}}(e),function(t){s(),e(t).on("click",function(){o.fadeIn(function(){o.height(e(document).outerHeight())})})});return{init:t}}(jQuery);return c}),define("taoQtiItem/qtiCreator/editor/preparePrint",["jquery","taoQtiItem/qtiCreator/editor/base"],function(e,t){"use strict";var i=function(){function i(t){return t.siblings().each(function(){e(this).addClass("item-no-print")}),t.parent()}for(var n=i(t.scope.parent());n.length&&"body"!==n.get(0).nodeName.toLowerCase();)n=i(n);t.toolbar.add(t.sidebars).add(t.overlay).addClass("item-no-print")};return e("#print-trigger").on("click",function(){window.print()}),i}),function(e){function t(){if(e.browser.msie){var t=e(document).height(),i=e(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>t-i?i:t]}return[e(document).width(),e(document).height()]}function i(t){return t?t.call(e.mask):void 0}e.tools=e.tools||{version:"v1.2.7"};var n;n=e.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var r,o,a,s,c;e.mask={load:function(l,d){if(a)return this;"string"==typeof l&&(l={color:l}),l=l||s,s=l=e.extend(e.extend({},n.conf),l),r=e("#"+l.maskId),r.length||(r=e("<div/>").attr("id",l.maskId),e("body").append(r));var u=t();return r.css({position:"absolute",top:0,left:0,width:u[0],height:u[1],display:"none",opacity:l.startOpacity,zIndex:l.zIndex}),l.color&&r.css("backgroundColor",l.color),i(l.onBeforeLoad)===!1?this:(l.closeOnEsc&&e(document).on("keydown.mask",function(t){27==t.keyCode&&e.mask.close(t)}),l.closeOnClick&&r.on("click.mask",function(t){e.mask.close(t)}),e(window).on("resize.mask",function(){e.mask.fit()}),d&&d.length&&(c=d.eq(0).css("zIndex"),e.each(d,function(){var t=e(this);/relative|absolute|fixed/i.test(t.css("position"))||t.css("position","relative")}),o=d.css({zIndex:Math.max(l.zIndex+1,"auto"==c?0:c)})),r.css({display:"block"}).fadeTo(l.loadSpeed,l.opacity,function(){e.mask.fit(),i(l.onLoad),a="full"}),a=!0,this)},close:function(){if(a){if(i(s.onBeforeClose)===!1)return this;r.fadeOut(s.closeSpeed,function(){i(s.onClose),o&&o.css({zIndex:c}),a=!1}),e(document).off("keydown.mask"),r.off("click.mask"),e(window).off("resize.mask")}return this},fit:function(){if(a){var e=t();r.css({width:e[0],height:e[1]})}},getMask:function(){return r},isLoaded:function(e){return e?"full"==a:a},getConf:function(){return s},getExposed:function(){return o}},e.fn.mask=function(t){return e.mask.load(t),this},e.fn.expose=function(t){return e.mask.load(t,this),this}}(jQuery),define("jquerytools",function(){}),define("taoQtiItem/qtiCreator/editor/toggleAppearance",["jquery","jquerytools","taoQtiItem/qtiCreator/editor/base"],function(e,t,i){"use strict";var n=function(){{var t=e("#appearance-trigger"),n=t.find(".menu-label"),r=t.data("item"),o=t.data("widget");!!i.widgetBar.find(".active-widget").length}t.on("click",function(){i.widgetBar.is(":visible")?(i.widgetBar.hide(),i.itemBar.slideDown(),n.text(o)):(i.itemBar.hide(),i.widgetBar.slideDown(),n.text(r))})};return n}),define("taoQtiItem/qtiCreator/editor/widgetCommon",["jquery","taoQtiItem/qtiCreator/editor/base"],function(e,t){"use strict";var i=function(){var i=["h2","h3","h4","h5","h6","address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","header","hgroup","hr","noscript","ol","output","p","pre","section","table","tfoot","ul","video"],n=i.join(","),r=t.getActiveItem(),o=t.getActiveWidget(),a=r.find(".item-editor-widget"),s=o.find(n),c=o.find(".active-block");a.on("click",function(i){c=e(i.target).closest(n),o=e(this),o.hasClass("active-widget")||(a.removeClass("active-widget"),o.addClass("active-widget"),t.setActiveWidget(o),s.removeClass("active-block")),c.hasClass("active-widget")||(s.removeClass("active-block"),c.addClass("active-block"),t.setActiveBlock(c))})}();return i}),define("taoQtiItem/qtiCreator/editor/listStyler",["jquery","taoQtiItem/qtiCreator/editor/base","taoQtiItem/qtiCreator/editor/widgetCommon"],function(e,t){"use strict";var i=function(){var i=t.widgetBar.find(".item-editor-list-styler"),n=[],r=["square","circle","disc"],o=function(t){var i=t.text.match(/\(([^\.\)]+)\.?\)$/)||[],n=!!i.length,r=i.pop()||"",o=i.pop()||"",a='<span class="list-symbol">'+(r||"&nbsp;")+"</span> ";return n&&(t.text=e.trim(t.text.slice(0,-o.length))),a+t.text};i.find("option").each(function(){n.push(this.value)}),n=n.join(","),i.on("change",function(){var o=t.getActiveBlock();if(!o.length)return!1;var a,s=i.val(),c=o.get(0).nodeName.toLowerCase(),l=e.inArray(s,r)>-1?"ul":"ol";return o.hasClass(s)?!1:(c!==l&&(a=e("<"+l+">",{"class":o.get(0).className}),o.find("li").each(function(){a.append(e(this).clone())}),o.replaceWith(a),o=a,t.setActiveBlock(o)),void o.removeClass(n).addClass(s))}).select2({width:"100%",formatResult:o,minimumResultsForSearch:-1})};return i}),define("taoQtiItem/qtiItem/core/qtiClasses",[],function(){return{_container:"taoQtiItem/qtiItem/core/Container",assessmentItem:"taoQtiItem/qtiItem/core/Item",responseProcessing:"taoQtiItem/qtiItem/core/ResponseProcessing",_simpleFeedbackRule:"taoQtiItem/qtiItem/core/response/SimpleFeedbackRule",stylesheet:"taoQtiItem/qtiItem/core/Stylesheet",math:"taoQtiItem/qtiItem/core/Math",img:"taoQtiItem/qtiItem/core/Img",object:"taoQtiItem/qtiItem/core/Object",outcomeDeclaration:"taoQtiItem/qtiItem/core/variables/OutcomeDeclaration",responseDeclaration:"taoQtiItem/qtiItem/core/variables/ResponseDeclaration",rubricBlock:"taoQtiItem/qtiItem/core/RubricBlock",associableHotspot:"taoQtiItem/qtiItem/core/choices/AssociableHotspot",gap:"taoQtiItem/qtiItem/core/choices/Gap",gapImg:"taoQtiItem/qtiItem/core/choices/GapImg",gapText:"taoQtiItem/qtiItem/core/choices/GapText",hotspotChoice:"taoQtiItem/qtiItem/core/choices/HotspotChoice",hottext:"taoQtiItem/qtiItem/core/choices/Hottext",inlineChoice:"taoQtiItem/qtiItem/core/choices/InlineChoice",simpleAssociableChoice:"taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice",simpleChoice:"taoQtiItem/qtiItem/core/choices/SimpleChoice",associateInteraction:"taoQtiItem/qtiItem/core/interactions/AssociateInteraction",choiceInteraction:"taoQtiItem/qtiItem/core/interactions/ChoiceInteraction",endAttemptInteraction:"taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction",extendedTextInteraction:"taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction",gapMatchInteraction:"taoQtiItem/qtiItem/core/interactions/GapMatchInteraction",graphicAssociateInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction",graphicOrderInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction",hotspotInteraction:"taoQtiItem/qtiItem/core/interactions/HotspotInteraction",hottextInteraction:"taoQtiItem/qtiItem/core/interactions/HottextInteraction",inlineChoiceInteraction:"taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction",matchInteraction:"taoQtiItem/qtiItem/core/interactions/MatchInteraction",mediaInteraction:"taoQtiItem/qtiItem/core/interactions/MediaInteraction",orderInteraction:"taoQtiItem/qtiItem/core/interactions/OrderInteraction",prompt:"taoQtiItem/qtiItem/core/interactions/Prompt",selectPointInteraction:"taoQtiItem/qtiItem/core/interactions/SelectPointInteraction",sliderInteraction:"taoQtiItem/qtiItem/core/interactions/SliderInteraction",textEntryInteraction:"taoQtiItem/qtiItem/core/interactions/TextEntryInteraction",uploadInteraction:"taoQtiItem/qtiItem/core/interactions/UploadInteraction",feedbackBlock:"taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock",feedbackInline:"taoQtiItem/qtiItem/core/feedbacks/FeedbackInline",modalFeedback:"taoQtiItem/qtiItem/core/feedbacks/ModalFeedback"}}),define("taoQtiItem/qtiItem/helper/util",[],function(){return{buildSerial:function(e){for(var t=e||"",i="abcdefghijklmnopqrstuvwxyz0123456789",n=0;22>n;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}}}),define("taoQtiItem/qtiItem/helper/rendererConfig",["lodash","jquery"],function(e,t){var i={};return i.getOptionsFromArguments=function(i){var n={data:{},placeholder:null,subclass:"",renderer:null};return e.each(i,function(r){r&&(r.isRenderer?n.renderer=r:r instanceof t&&r.length?n.placeholder=r:e.isString(r)?n.subclass=r:e.isPlainObject(r)?n.data=r:console.log("invalid arg",r,i))}),n},i}),define("taoQtiItem/qtiItem/core/Element",["class","lodash","taoQtiItem/qtiItem/helper/util","taoQtiItem/qtiItem/helper/rendererConfig"],function(e,t,i,n){var r={},o=e.extend({qtiClass:"",serial:"",relatedItem:null,init:function(e,t){if(this.attributes={},this.metaData={},"object"==typeof e&&(t=e,e=""),e||(e=i.buildSerial(this.qtiClass+"_")),e&&("string"!=typeof e||!e.match(/^[a-z_0-9]*$/i)))throw"invalid QTI serial : ("+typeof e+") "+e;if(r[e])throw"a QTI Element with the same serial already exists "+e;r[e]=this,this.serial=e,this.setAttributes(t||{}),"function"==typeof this.initContainer&&this.initContainer(arguments[2]||""),"function"==typeof this.initObject&&this.initObject()},is:function(e){return e===this.qtiClass},placeholder:function(){return"{{"+this.serial+"}}"},getSerial:function(){return this.serial},getUsedIdentifiers:function(){var e={},t=this.getComposingElements();for(var i in t){var n=t[i],r=n.attr("identifier");r&&(e[r]=n)}return e},attr:function(e,t){if(e)if(void 0!==t)this.attributes[e]=t;else if("object"==typeof e)for(var i in e)this.attr(i,e[i]);else if("string"==typeof e)return void 0===this.attributes[e]?null:this.attributes[e];return this},data:function(e,t){if(e)if(void 0!==t)this.metaData[e]=t,$(document).trigger("metaChange.qti-widget",{element:this,key:e,value:t});else if("object"==typeof e)for(var i in e)this.data(i,e[i]);else if("string"==typeof e)return void 0===this.metaData[e]?null:this.metaData[e];return this},removeAttr:function(e){return this.removeAttributes(e)},setAttributes:function(e){return this.attributes=e,this},getAttributes:function(){return t.clone(this.attributes)},removeAttributes:function(e){"string"==typeof e&&(e=[e]);for(var t in e)delete this.attributes[e[t]];return this},getComposingElements:function(){var e={};if("function"==typeof this.initContainer){var i=this.getBody();e[i.getSerial()]=i,e=t.extend(e,i.getComposingElements())}if("function"==typeof this.initObject){var n=this.getObject();e[n.getSerial()]=n,e=t.extend(e,n.getComposingElements())}return e},getUsedClasses:function(){var e=[this.qtiClass],i=this.getComposingElements();return t.each(i,function(t){e.push(t.qtiClass)}),t.uniq(e)},find:function(e){if("function"==typeof this.initObject){var t=this.getObject();if(t.serial===e)return{parent:this,element:t,location:"object"}}if("function"==typeof this.initContainer){var i=this.getBody().getElements();if(i[e])return{parent:this,element:i[e],location:"body"};for(var n in i){var r=i[n].find(e);if(r)return r}}return null},parent:function(){var e=this.getRelatedItem();if(e){var t=e.find(this.getSerial());if(t)return t.parent}return null},setRelatedItem:function(e,t){if(t="undefined"==typeof t?!0:t,o.isA(e,"assessmentItem")){this.relatedItem=e;var i=this.getComposingElements();for(var n in i)i[n].setRelatedItem(e,!1)}},getRelatedItem:function(){var e=null;return o.isA(this.relatedItem,"assessmentItem")&&(e=this.relatedItem),e},setRenderer:function(e){if(!e||!e.isRenderer)throw"invalid qti rendering engine";this.renderer=e;var t=this.getComposingElements();for(var i in t)t[i].setRenderer(e)},getRenderer:function(){return this.renderer},render:function(){var e=n.getOptionsFromArguments(arguments),i=e.renderer||this.getRenderer(),r={},o={tag:this.qtiClass,serial:this.serial,attributes:this.getAttributes()};
if(!i)throw"render: no renderer found for the element "+this.qtiClass+":"+this.serial;if("function"==typeof this.initContainer&&(o.body=this.getBody().render(i)),"function"==typeof this.initObject){o.object={attributes:this.object.getAttributes()};var a=o.object.attributes.data,s=i.getOption("baseUrl");s&&(/^http(s)?:\/\//.test(a)||(o.object.attributes.data=s+a))}r=t.merge(o,e.data||{}),r=i.getData(this,r,e.subclass);var c=i.renderTpl(this,r,e.subclass);return e.placeholder&&e.placeholder.replaceWith(c),c},postRender:function(e,t,i){if(i=i||this.getRenderer(),"function"==typeof this.initContainer&&this.getBody().postRender({},"",i),i)return i.postRender(this,e,t);throw"postRender: no renderer found for the element "+this.qtiClass+":"+this.serial},getContainer:function(e){var t=this.getRenderer();if(t)return t.getContainer(this,e);throw"getContainer: no renderer found for the element "+this.qtiClass+":"+this.serial},toArray:function(){var e={serial:this.serial,type:this.qtiClass,attributes:this.getAttributes()};return"function"==typeof this.initContainer&&(e.body=this.getBody().toArray()),"function"==typeof this.initObject&&(e.object=this.object.toArray()),e},remove:function(e,t){if(this[e]){var i="";"string"==typeof t?i=t:t instanceof o&&(i=t.getSerial()),i&&delete this[e][i]}return this}});return o.isA=function(e,t){return e instanceof o&&e.is(t)},o.getElementBySerial=function(e){return r[e]},o.unsetElement=function(e){delete r[e]},o}),define("taoQtiItem/qtiItem/core/Loader",["lodash","class","taoQtiItem/qtiItem/core/qtiClasses","taoQtiItem/qtiItem/core/Element"],function(e,t,i,n){var r=t.extend({qti:{},classesLocation:{},init:function(e,t){this.item=e||null,this.setClassesLocation(t||i)},setClassesLocation:function(t){return e.extend(this.classesLocation,t),this},getRequiredClasses:function(t){var i=[];for(var n in t)"qtiClass"===n&&"_container"!==t[n]&&"relatedItem"!==n?i.push(t[n]):"object"==typeof t[n]&&(i=e.union(i,this.getRequiredClasses(t[n])));return i},loadRequiredClasses:function(t,i,n){var r=this.getRequiredClasses(t,n),o=[];for(var a in r){var s=r[a];if(!this.classesLocation[s])throw new Error("missing qti class location declaration : "+s);o.push(this.classesLocation[s])}var c=this;require(o,function(){e.each(arguments,function(e){c.qti[e.prototype.qtiClass]=e}),i.call(c,c.qti)})},getLoadedClasses:function(){return e.keys(this.qti)},loadItemData:function(t,i){var n=this;n.loadRequiredClasses(t,function(r){if("object"==typeof t&&"assessmentItem"===t.qtiClass){n.item=new r.assessmentItem(t.serial,t.attributes||{}),n.loadContainer(n.item.getBody(),t.body);for(var o in t.outcomes){var a=n.buildOutcome(t.outcomes[o]);a&&n.item.addOutcomeDeclaration(a)}for(var o in t.feedbacks){var s=n.buildElement(t.feedbacks[o]);s&&n.item.addModalFeedback(s)}for(var o in t.stylesheets){var c=n.buildElement(t.stylesheets[o]);c&&n.item.addStylesheet(c)}for(var o in t.responses){var l=n.buildResponse(t.responses[o]);if(l){n.item.addResponseDeclaration(l);var d=t.responses[o].feedbackRules;d&&e.forIn(d,function(e,t){l.feedbackRules[t]=n.buildSimpleFeedbackRule(e)})}}t.responseProcessing&&n.item.setResponseProcessing(n.buildResponseProcessing(t.responseProcessing)),n.item.setNamespaces(t.namespaces)}"function"==typeof i&&i.call(n,n.item)})},loadElements:function(e,t){var i=this;if(!i.item)throw"QtiLoader : cannot load elements in empty item";this.loadRequiredClasses(e,function(){var n=i.item.getComposingElements();for(var r in e){var o=e[r];o&&o.qtiClass&&o.serial&&n[o.serial]&&i.loadElementData(n[o.serial],o)}"function"==typeof t&&t.call(i,i.item)})},buildResponse:function(e){var t=this.buildElement(e);return t.template=e.howMatch||null,t.defaultValue=e.defaultValue||null,t.correctResponse=e.correctResponses||null,t.mapEntries=e.mapping||e.areaMapping||{},t.mappingAttributes=e.mappingAttributes||{},t},buildSimpleFeedbackRule:function(e){var t=this.buildElement(e);return e.condition&&(t.condition=e.condition),e.comparedValue&&(t.comparedValue=e.comparedValue),t.comparedOutcome=this.item.responses[e.comparedOutcome]||null,t.feedbackOutcome=this.item.outcomes[e.feedbackOutcome]||null,t.feedbackThen=this.item.modalFeedbacks[e.feedbackThen]||null,t.feedbackElse=this.item.modalFeedbacks[e.feedbackElse]||null,t},buildOutcome:function(e){var t=this.buildElement(e);return t.defaultValue=e.defaultValue||null,t},buildResponseProcessing:function(e){var t=this.buildElement(e);return e&&e.processingType&&("custom"===e.processingType?(t.xml=e.data,t.processingType="custom"):t.processingType="templateDriven"),t},loadContainer:function(e,t){if(!n.isA(e,"_container"))throw"bodyObject must be a QTI Container";if(!t||"string"!=typeof t.body||"array"!=typeof t.elements&&"object"!=typeof t.elements)throw"wrong bodydata format";for(var i in t.elements){var r=t.elements[i],o=this.buildElement(r);o&&e.setElement(o,t.body)}e.body(t.body)},buildElement:function(e){var t=null;if(!(e&&e.qtiClass&&e.serial))throw"wrong elementData format";var i=e.qtiClass;if(!this.qti[i])throw"the qti element class does not exist: "+i;return t=new this.qti[i](e.serial),this.loadElementData(t,e),t},loadElementData:function(t,i){return t.setAttributes(e.clone(i.attributes)||{}),t.body&&i.body&&t.bdy&&this.loadContainer(t.getBody(),i.body),t.object&&i.object&&t.object&&this.loadObjectData(t.object,i.object),n.isA(t,"interaction")?this.loadInteractionData(t,i):n.isA(t,"choice")?this.loadChoiceData(t,i):n.isA(t,"math")&&this.loadMathData(t,i),t},loadInteractionData:function(e,t){n.isA(e,"blockInteraction")&&t.prompt&&this.loadContainer(e.prompt.getBody(),t.prompt),this.buildInteractionChoices(e,t)},buildInteractionChoices:function(e,t){if(t.choices){if(n.isA(e,"matchInteraction"))for(var i=0;2>i;i++){if(!t.choices[i])throw"missing match set #"+i;var r=t.choices[i];for(var o in r){var a=this.buildElement(r[o]);a&&e.addChoice(a,i)}}else for(var o in t.choices){var a=this.buildElement(t.choices[o]);a&&e.addChoice(a)}if(n.isA(e,"graphicGapMatchInteraction")&&t.gapImgs)for(var o in t.gapImgs){var s=this.buildElement(t.gapImgs[o]);s&&e.addGapImg(s)}}},loadChoiceData:function(e,t){n.isA(e,"textVariableChoice")?e.val(t.text):n.isA(e,"gapImg")||n.isA(e,"containerChoice")},loadObjectData:function(e,t){e.setAttributes(t.attributes),t.alt&&t.alt.qtiClass&&"object"===t.alt.qtiClass&&(e.alt=t.alt)},loadMathData:function(e,t){e.mathML=t.mathML||"",e.annotations=t.annotations||{}}});return r}),define("taoQtiItem/qtiCreator/model/helper/event",["jquery","taoQtiItem/qtiItem/core/Element"],function(e,t){return{choiceCreated:function(t,i){e(document).trigger("choiceCreated.qti-widget",{choice:t,interaction:i})},deleted:function(i,n){t.unsetElement(i.getSerial()),e(document).off("."+i.getSerial()),e(document).trigger("deleted.qti-widget",{element:i,parent:n})}}}),define("taoQtiItem/qtiCreator/model/mixin/editable",["lodash","jquery","taoQtiItem/qtiItem/core/Element","taoQtiItem/qtiCreator/model/helper/event"],function(e,t,i,n){var r=function(t,i){var n=i.id().replace(/([.-])/g,"\\$1"),r=new RegExp("([^a-z_-d.]*)("+n+")([^a-z_-d.]*)");for(var o in t.correctResponse)t.correctResponse[o].match(r)&&delete t.correctResponse[o];var a={};e.forIn(t.mapEntries,function(e,t){t.match(r)||(a[t]=e)}),t.mapEntries=a},o=function(e){var t=!1,o=e.getRelatedItem();if(o){var a=o.find(e.getSerial());if(a){var s=a.parent;i.isA(s,"interaction")&&i.isA(e,"choice")?(s.removeChoice(e),r(s.getResponseDeclaration(),e),t=!0):"function"==typeof s.initContainer&&"body"===a.location&&(s.getBody().removeElement(e),t=!0),t&&n.deleted(e,s)}}return t},a=function(e,t,n){if(e[t]){var r="";"string"==typeof n?r=n:n instanceof i&&(r=n.getSerial()),r&&(delete e[t][r],i.unsetElement(r))}return e},s=function(e,t){var i=new RegExp("(?:^|\\s)"+t+"(?:\\s|$)","");return e&&i.test(e)},c={init:function(t,i){"object"==typeof t&&(i=t,t="");var n={};e.isFunction(this.getDefaultAttributes)&&e.extend(n,this.getDefaultAttributes()),e.extend(n,i),this._super(t,n)},attr:function(e,i){var n=this._super(e,i);return void 0!==e&&void 0!==i&&t(document).trigger("attributeChange.qti-widget",{element:this,key:e,value:i}),n},remove:function(){if(0===arguments.length)return o(this);if(2===arguments.length)return a(this,arguments[0],arguments[1]);throw"invalid number of argument given"},addClass:function(e){var t=this.attr("class")||"";s(t,e)||this.attr("class",t+(t.length?" ":"")+e)},hasClass:function(e){return s(this.attr("class"),e)},removeClass:function(e){var t=this.attr("class")||"";if(t){var i=new RegExp("(?:^|\\s)"+e+"(?:\\s|$)","");t=t.replace(i,"").replace(/^\s+/,""),t?this.attr("class",t):this.removeAttr("class")}}};return c}),define("taoQtiItem/qtiCreator/model/qtiClasses",["lodash","taoQtiItem/qtiItem/core/qtiClasses"],function(e,t){return e.defaults({assessmentItem:"taoQtiItem/qtiCreator/model/Item",img:"taoQtiItem/qtiCreator/model/Img",math:"taoQtiItem/qtiCreator/model/Math",rubricBlock:"taoQtiItem/qtiCreator/model/RubricBlock",modalFeedback:"taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback",choiceInteraction:"taoQtiItem/qtiCreator/model/interactions/ChoiceInteraction",orderInteraction:"taoQtiItem/qtiCreator/model/interactions/OrderInteraction",associateInteraction:"taoQtiItem/qtiCreator/model/interactions/AssociateInteraction",inlineChoiceInteraction:"taoQtiItem/qtiCreator/model/interactions/InlineChoiceInteraction",simpleChoice:"taoQtiItem/qtiCreator/model/choices/SimpleChoice",simpleAssociableChoice:"taoQtiItem/qtiCreator/model/choices/SimpleAssociableChoice",inlineChoice:"taoQtiItem/qtiCreator/model/choices/InlineChoice",mediaInteraction:"taoQtiItem/qtiCreator/model/interactions/MediaInteraction",hotspotInteraction:"taoQtiItem/qtiCreator/model/interactions/HotspotInteraction",selectPointInteraction:"taoQtiItem/qtiCreator/model/interactions/SelectPointInteraction",graphicInteraction:"taoQtiItem/qtiCreator/model/interactions/GraphicOrderInteraction",graphicAssociateInteraction:"taoQtiItem/qtiCreator/model/interactions/GraphicAssociateInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiCreator/model/interactions/GraphicGapMatchInteraction",hotspotChoice:"taoQtiItem/qtiCreator/model/choices/HotspotChoice",responseDeclaration:"taoQtiItem/qtiCreator/model/variables/ResponseDeclaration",responseProcessing:"taoQtiItem/qtiCreator/model/ResponseProcessing"},t)}),define("taoQtiItem/qtiCreator/model/helper/container",["lodash","taoQtiItem/qtiCreator/model/qtiClasses"],function(e,t){var i={createElements:function(i,n,r){var o=/{{([a-z0-9_]*):new}}/gi,a={};n.replace(o,function(e,i){if(!t[i])throw"missing required class : "+i;a[i]=t[i]}),require(e.values(a),function(){var e={};for(var t in arguments)e[arguments[t].prototype.qtiClass]=arguments[t];var a={},s=n.replace(o,function(t,n){if(e[n]){var r=new e[n];return i.getRenderer()&&r.setRenderer(i.getRenderer()),a[r.getSerial()]=r,r.placeholder()}return t});i.setElements(a,s);for(var t in a){var c=a[t];"function"==typeof c.buildIdentifier&&c.buildIdentifier(),"function"==typeof c.afterCreate&&c.afterCreate(),$(document).trigger("elementCreated.qti-widget",{parent:i.parent(),element:c})}"function"==typeof r&&r.call(i,a)})}};return i}),define("taoQtiItem/qtiCreator/model/mixin/editableContainer",["taoQtiItem/qtiCreator/model/helper/container"],function(e){var t={createElements:function(t,i){var n=this;e.createElements(n.getBody(),t,function(e){i.call(n,e)})}};return t}),define("taoQtiItem/qtiItem/core/IdentifiedElement",["taoQtiItem/qtiItem/core/Element"],function(e){var t=e.extend({buildIdentifier:function(e,t){void 0===t&&(t=!0);var i=this.getRelatedItem();if(!i)throw"cannot build identifier of an element that is not attached to an assessment item";var n="",r=1,o=i.getUsedIdentifiers();e?(e=e.replace(/_[0-9]+$/gi,"_"),e=e.replace(/[^a-zA-Z0-9_]/gi,"_"),e=e.replace(/(_)+/gi,"_"),t&&(n="_"+r)):(e=this.qtiClass,n="_"+r);do{var a=!1,s=e+n;o[s]&&(a=!0,n="_"+r,r++)}while(a);return this.attr("identifier",s),this},id:function(e){return e||this.attr("identifier")||this.buildIdentifier(e),this.attr("identifier",e)}});return t}),define("taoQtiItem/qtiItem/mixin/Mixin",[],function(){return{augment:function(e,t,i){if("function"==typeof e&&"object"==typeof t)for(var n in t)if(Object.hasOwnProperty(e.prototype,n)){if(i&&i.append){var r=e.prototype[n];e.prototype[n]=function(){return t[n].apply(this,arguments),r.apply(this,arguments)}}}else e.prototype[n]=t[n]}}}),define("taoQtiItem/qtiItem/core/Container",["taoQtiItem/qtiItem/core/Element","lodash","jquery","taoQtiItem/qtiItem/helper/rendererConfig"],function(e,t,i,n){var r=e.extend({qtiClass:"_container",init:function(e){if(e&&"string"!=typeof e)throw"the body of a container must be a string";this.bdy="",this.body(e||""),this.elements=[],this._super()},body:function(e){if("undefined"==typeof e)return this.bdy;if("string"!=typeof e)throw"body must be a string";this.bdy=e,i(document).trigger("containerBodyChange",{body:e,container:this})},setElements:function(t,n){var r=!1;for(var o in t){var a=t[o];if(!(a instanceof e))throw r=!1,"expected a qti element";-1===n.indexOf(a.placeholder())&&(n+=a.placeholder()),a.setRelatedItem(this.getRelatedItem()||null),this.elements[a.getSerial()]=a,i(document).trigger("containerElementAdded",{element:a,container:this}),r=!0}return this.body(n),r},setElement:function(e,t){return this.setElements([e],t)},removeElement:function(t){var i="";return"string"==typeof t?i=t:t instanceof e&&(i=t.getSerial()),delete this.elements[i],this.body(this.body().replace("{{"+i+"}}","")),this},getElements:function(t){var i={};if("string"==typeof t)for(var n in this.elements)e.isA(this.elements[n],t)&&(i[n]=this.elements[n]);else i=this.elements;return i},getElement:function(e){return this.elements[e]?this.elements[e]:null},getComposingElements:function(){var e=this.getElements(),i={};for(var n in e)i[n]=e[n],i=t.extend(i,e[n].getComposingElements());return i},render:function(){var e=n.getOptionsFromArguments(arguments),t=e.renderer||this.getRenderer(),i=[],r=this.body();for(var o in this.elements){var a=this.elements[o];if("function"!=typeof a.render)throw"render() is not defined for the qti element: "+o;"_container"===a.qtiClass?r=r.replace(a.placeholder(),a.render(t)):(r=r.replace(a.placeholder(),"{{{"+o+"}}}"),i[o]=a.render(t))}if(t.isRenderer)return this._super({body:t.renderDirect(r,i),contentModel:this.contentModel||"flow"},t);throw"invalid qti renderer for qti container"},postRender:function(e,t,i){i=i||this.getRenderer();for(var n in this.elements){var r=this.elements[n];"function"==typeof r.postRender&&r.postRender(e,"",i)}this._super(e,t,i)},toArray:function(){var e={serial:this.serial,body:this.bdy,elements:{}};for(var t in this.elements)e.elements[t]=this.elements[t].toArray();return e}});return r}),define("taoQtiItem/qtiItem/mixin/Container",["taoQtiItem/qtiItem/mixin/Mixin","taoQtiItem/qtiItem/core/Container"],function(e,t){var i={initContainer:function(e){this.bdy=new t(e||""),this.bdy.setRelatedItem(this.getRelatedItem()||null),this.bdy.contentModel="blockStatic"},getBody:function(){return this.bdy},body:function(e){var t=this.bdy.body(e);return e?this:t},setElement:function(e,t){return this.bdy.setElement(e,t),this},removeElement:function(e){return this.bdy.removeElement(e)}};return{augment:function(t){e.augment(t,i)},methods:i}}),define("taoQtiItem/qtiItem/mixin/ContainerItemBody",["taoQtiItem/qtiItem/mixin/Mixin","taoQtiItem/qtiItem/mixin/Container","lodash"],function(e,t,i){var n={};return i.extend(n,t.methods),i.extend(n,{initContainer:function(e){t.methods.initContainer.call(this,e),this.bdy.contentModel="itemBody"}}),{augment:function(t){e.augment(t,n)},methods:n}}),define("taoQtiItem/qtiItem/core/Item",["taoQtiItem/qtiItem/core/Element","taoQtiItem/qtiItem/core/IdentifiedElement","taoQtiItem/qtiItem/mixin/ContainerItemBody","lodash"],function(e,t,i,n){var r=t.extend({qtiClass:"assessmentItem",init:function(e,t){this._super(e,t),this.relatedItem=this,this.stylesheets={},this.responses={},this.outcomes={},this.modalFeedbacks={},this.responseProcessing=null},getInteractions:function(){var t=[],i=this.getComposingElements();for(var n in i)e.isA(i[n],"interaction")&&t.push(i[n]);return t},addResponseDeclaration:function(t){if(!e.isA(t,"responseDeclaration"))throw"is not a qti response declaration";return t.setRelatedItem(this),this.responses[t.getSerial()]=t,this},getResponseDeclaration:function(e){for(var t in this.responses)if(this.responses[t].attr("identifier")===e)return this.responses[t];return null},addOutcomeDeclaration:function(t){if(!e.isA(t,"outcomeDeclaration"))throw"is not a qti outcome declaration";return t.setRelatedItem(this),this.outcomes[t.getSerial()]=t,this},addModalFeedback:function(t){if(!e.isA(t,"modalFeedback"))throw"is not a qti modal feedback";return t.setRelatedItem(this),this.modalFeedbacks[t.getSerial()]=t,this},getComposingElements:function(){var t=this._super(),i=this;return n.each(["responses","outcomes","modalFeedbacks","stylesheets"],function(e){for(var r in i[e]){var o=i[e][r];t[r]=o,t=n.extend(t,o.getComposingElements())}}),this.responseProcessing instanceof e&&(t[this.responseProcessing.getSerial()]=this.responseProcessing),t},find:function(e){var t=this,i=this._super(e);return i||n.each(["responses","outcomes","modalFeedbacks","stylesheets"],function(r){var o=t[r][e];return o?(i={parent:this,element:o},!1):(n.each(t[r],function(t){return i=t.find(e),i?!1:void 0}),i?!1:void 0)}),i},getResponses:function(){return n.clone(this.responses)},getRelatedItem:function(){return this},setNamespaces:function(e){this.namespaces=e},getNamespaces:function(){return n.clone(this.namespaces)},addStylesheet:function(t){if(!e.isA(t,"stylesheet"))throw"is not a qti stylesheet declaration";return t.setRelatedItem(this),this.stylesheets[t.getSerial()]=t,this},setResponseProcessing:function(t){if(!e.isA(t,"responseProcessing"))throw"is not a response processing";return t.setRelatedItem(this),this.responseProcessing=t,this},toArray:function(){var e=this._super();e.outcomes={};for(var t in this.outcomes)e.outcomes[t]=this.outcomes[t].toArray();e.responses={};for(var t in this.responses)e.responses[t]=this.responses[t].toArray();return e.namespaces=this.namespaces,e.stylesheets=this.stylesheets,e}});return i.augment(r),r}),define("taoQtiItem/qtiItem/core/Stylesheet",["taoQtiItem/qtiItem/core/Element","lodash","taoQtiItem/qtiItem/helper/rendererConfig"],function(e,t,i){var n=e.extend({qtiClass:"stylesheet",render:function(){var e=i.getOptionsFromArguments(arguments),n=e.renderer||this.getRenderer(),r={},o=n.getOption("baseUrl")||"",a=this.attr("href");return a.match(/^http/i)||(r.attributes={href:o+a}),this._super(t.merge(r,e.data),e.placeholder,e.subclass,n)}});return n}),define("taoQtiItem/qtiCreator/model/Stylesheet",["lodash","taoQtiItem/qtiCreator/model/mixin/editable","taoQtiItem/qtiItem/core/Stylesheet"],function(e,t,i){var n={};return e.extend(n,t),e.extend(n,{getDefaultAttributes:function(){return{href:"css/tao-user-styles.css",title:"",type:"text/css",media:"all"}}}),i.extend(n)}),define("taoQtiItem/qtiItem/core/ResponseProcessing",["taoQtiItem/qtiItem/core/Element","lodash"],function(e){var t=e.extend({qtiClass:"responseProcessing",processingType:"",xml:""});return t}),define("taoQtiItem/qtiCreator/model/ResponseProcessing",["lodash","taoQtiItem/qtiCreator/model/mixin/editable","taoQtiItem/qtiItem/core/ResponseProcessing"],function(e,t,i){var n={};return e.extend(n,t),e.extend(n,{getDefaultAttributes:function(){return{}},setProcessingType:function(t){this.processingType!==t&&("custom"===this.processingType&&e.each(this.getRelatedItem().getResponses(),function(e){e.setTemplate("MATCH_CORRECT")}),this.processingType=t)}}),i.extend(n)}),define("taoQtiItem/qtiItem/core/variables/VariableDeclaration",["taoQtiItem/qtiItem/core/IdentifiedElement"],function(e){var t=e.extend({init:function(e,t){this._super(e,t),this.defaultValue=null},is:function(e){return"variableDeclaration"===e||this._super(e)},toArray:function(){var e=this._super();return e.defaultValue=this.defaultValue,e}});return t}),define("taoQtiItem/qtiItem/core/variables/OutcomeDeclaration",["taoQtiItem/qtiItem/core/variables/VariableDeclaration"],function(e){return e.extend({qtiClass:"outcomeDeclaration"})}),define("taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration",["lodash","taoQtiItem/qtiCreator/model/mixin/editable","taoQtiItem/qtiItem/core/variables/OutcomeDeclaration"],function(e,t,i){var n={};return e.extend(n,t),i.extend(n)}),define("taoQtiItem/qtiItem/core/feedbacks/ModalFeedback",["taoQtiItem/qtiItem/core/IdentifiedElement","taoQtiItem/qtiItem/mixin/Container"],function(e,t){var i=e.extend({qtiClass:"modalFeedback",is:function(e){return"feedback"===e||this._super(e)}});return t.augment(i),i}),define("taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback",["lodash","taoQtiItem/qtiCreator/model/mixin/editable","taoQtiItem/qtiItem/core/feedbacks/ModalFeedback"],function(e,t,i){var n={};return e.extend(n,t),e.extend(n,{getDefaultAttributes:function(){return{title:"modal feedback title",showHide:"show"}}}),i.extend(n)}),define("taoQtiItem/qtiCreator/model/Item",["lodash","taoQtiItem/qtiCreator/model/mixin/editable","taoQtiItem/qtiCreator/model/mixin/editableContainer","taoQtiItem/qtiItem/core/Item","taoQtiItem/qtiCreator/model/Stylesheet","taoQtiItem/qtiCreator/model/ResponseProcessing","taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration","taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback"],function(e,t,i,n,r,o,a,s){var c={};return e.extend(c,t),e.extend(c,i),e.extend(c,{getDefaultAttributes:function(){return{identifier:"myItem_1",title:"Item title",adaptive:!1,timeDependent:!1}},createResponseProcessing:function(){var e=new o;return e.processingType="templateDriven",this.setResponseProcessing(e),e},createStyleSheet:function(t){if(t&&e.isString(t)){var i=new r({href:t});return this.addStylesheet(i),i}throw'missing or invalid type for the required arg "href"'},createOutcomeDeclaration:function(e){var t=e.identifier||"";delete e.identifier;var i=new a(e);return this.addOutcomeDeclaration(i),i.buildIdentifier(t),i},createModalFeedback:function(e){var t=e.identifier||"";delete e.identifier;var i=new s(e);return this.addModalFeedback(i),i.buildIdentifier(t),i.body("Some feedback text."),i}}),n.extend(c)}),define("taoQtiItem/qtiCreator/helper/itemLoader",["jquery","helpers","taoQtiItem/qtiItem/core/Loader","taoQtiItem/qtiCreator/model/Item","taoQtiItem/qtiCreator/model/qtiClasses"],function(e,t,i,n,r){var o=function(e){var t=e.lastIndexOf("#");return e.substr(t)},a={loadItem:function(a,s){a.uri&&e.ajax({url:t._url("getItemData","QtiCreator","taoQtiItem"),dataType:"json",data:{uri:a.uri}}).done(function(e){if(e.itemData&&"assessmentItem"===e.itemData.qtiClass){var t=(new i).setClassesLocation(r),c=e.itemData;t.loadItemData(c,function(e){s(e,this.getLoadedClasses())})}else{var l=(new n).id(o(a.uri));l.createResponseProcessing(),s(l)}})}};return a}),define("taoQtiItem/qtiItem/helper/interactionHelper",["lodash","taoQtiItem/qtiItem/core/Element"],function(e,t){return{convertChoices:function(i,n){var r=[],o=this;return e.each(i,function(i){if(t.isA(i,"choice"))switch(n){case"serial":r.push(i.getSerial());break;case"identifier":r.push(i.id());break;default:r.push(i)}else e.isArray(i)&&r.push(o.convertChoices(i,n))}),r},findChoices:function(t,i,n){var r=[],o=this;return e.each(i,function(i){var a;e.isString(i)?"serial"===n?(a=t.getChoice(i),a&&r.push(a)):"identifier"===n?(a=t.getChoiceByIdentifier(i),a&&r.push(a)):r.push(i):r.push(e.isArray(i)?o.findChoices(t,i,n):i)}),r},shuffleChoices:function(e){var i=[],n={},r=0;for(var o in e){if(!t.isA(e[o],"choice"))throw"invalid element in array: is not a qti choice";var a=e[o];a.attr("fixed")&&(n[r]=a),i.push(a),r++}for(var s=0;s<i.length-1;s++)if(!n[s]){var c=-1;do c=s+Math.floor(Math.random()*(i.length-s));while(n[c]);var l=i[c];i[c]=i[s],i[s]=l}return i},serialToIdentifier:function(e,t){var i=e.getChoice(t);return i?i.id():""}}}),define("taoQtiItem/qtiRunner/core/Renderer",["lodash","jquery","handlebars","taoQtiItem/qtiItem/core/Element","taoQtiItem/qtiItem/helper/interactionHelper"],function(e,t,i,n,r){var o=function(t){var i=!0;if("object"!=typeof t)return!1;var n=!1;if(t.qtiClass)if(e.indexOf(a,t.qtiClass)>=0)n=!0;else{var r=t.qtiClass.indexOf(".");if(r>0){var o=t.qtiClass.slice(0,r),c=t.qtiClass.slice(r+1);s[o]&&e.indexOf(s[o],c)>=0&&(n=!0)}}if(!n)throw i=!1,new Error("invalid qti class name in renderer declaration : "+t.qtiClass);if(!t.template)throw i=!1,new Error("missing template in renderer declaration : "+t.qtiClass);return i},a=["_container","assessmentItem","stylesheet","responseDeclaration","outcomeDeclaration","responseProcessing","_simpleFeedbackRule","img","math","object","modalFeedback","rubricBlock","associateInteraction","choiceInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","endAttemptInteraction","prompt","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice"],s={simpleAssociableChoice:["associateInteraction","matchInteraction"],simpleChoice:["choiceInteraction","orderInteraction"]},c=["_container","prompt","modalFeedback"],l=function(l){l=l||{},this.isRenderer=!0,this.name="",this.shuffleChoices=void 0!==l.shuffleChoices?l.shuffleChoices:!0,this.shuffledChoices=[];var d={},u={},h=function(e){var t=null;if(u[e])t=u[e];else{var i=e.indexOf(".");i>0&&(e=e.slice(0,i),u[e]&&(t=u[e]))}return t};this.setOption=function(e,t){return"string"==typeof e&&(l[e]=t),this},this.getOption=function(e){return"string"==typeof e&&l[e]?l[e]:null},this.renderTpl=function(e,t,i){var n="",r=!1,o=i||e.qtiClass,a=h(o);if(a&&"function"==typeof a.template&&(n=a.template(t),r=!0),!r)throw new Error("no renderer template loaded under the class name : "+o);return n},this.getData=function(e,t,i){var n=t,r=i||e.qtiClass,o=h(r);return o&&"function"==typeof o.getData&&(n=o.getData.call(this,e,t)),n},this.renderDirect=function(e,t){return i.compile(e)(t)},this.getContainer=function(e,t){var i=null,n=h(e.qtiClass);if(!n)throw"no renderer found for the class : "+e.qtiClass;return i=n.getContainer(e,t)},this.postRender=function(e,t,i){var n=!1,r=i||e.qtiClass,o=h(r);return o&&"function"==typeof o.render&&(n=o.render.call(this,e,t)),n},this.setResponse=function(e,i,n){var r=!1,o=n||e.qtiClass,a=h(o);if(!a)throw"no renderer registered under the name : "+o;if("function"==typeof a.setResponse){r=a.setResponse.call(this,e,i);var s=a.getContainer.call(this,e);s instanceof t&&s.length&&s.trigger("responseSet",[e,i])}return r},this.getResponse=function(e,t){var i=!1,n=t||e.qtiClass,r=h(n);if(!r)throw"no renderer registered under the name : "+n;return"function"==typeof r.getResponse&&(i=r.getResponse.call(this,e)),i},this.resetResponse=function(e,t){var i=!1,n=t||e.qtiClass,r=h(n);if(!r)throw"no renderer registered under the name : "+n;return"function"==typeof r.resetResponse&&(i=r.resetResponse.call(this,e)),i},this.getLoadedRenderers=function(){return u},this.register=function(t){e.extend(d,t)},this.load=function(t,i){var n=[];if(i){if(!e.isArray(i))throw new Error('invalid argument type: expected array for arg "requireClasses"');i=e.intersection(i,a),i=e.union(i,c);for(var r in i){var l=i[r];if(s[l]){var h=e.intersection(i,s[l]);e.each(h,function(e){if(d[l+"."+e])n.push(d[l+"."+e]);else{if(!d[l])throw new Error(this.name+" : missing qti class location declaration: "+l+", subclass: "+e);n.push(d[l])}})}else if(d[l]===!1)u[l]=!1;else{if(!d[l])throw new Error(this.name+" : missing qti class location declaration: "+l);n.push(d[l])}}}else n=e.values(d);var f=this;return require(n,function(){e.each(arguments,function(e){o(e)&&(u[e.qtiClass]=e)}),"function"==typeof t&&t.call(f,u)}),this},this.setShuffledChoices=function(e,t,i){n.isA(e,"interaction")&&(this.shuffledChoices[e.getSerial()]=r.findChoices(e,t,i))},this.getShuffledChoices=function(t,i,o){var a,s=[];if(n.isA(t,"interaction")){var c=t.getSerial();if(!this.shuffledChoices[c]||i)if(n.isA(t,"matchInteraction")){this.shuffledChoices[c]=[];for(var l=0;2>l;l++)this.shuffledChoices[c].push(r.shuffleChoices(t.getChoices(l)))}else this.shuffledChoices[c]=r.shuffleChoices(t.getChoices());a=this.shuffledChoices[c],s="serial"===o||"identifier"===o?r.convertChoices(a,o):e.clone(a)}return s},this.getRenderers=function(){return u},this.getLocations=function(){return d}};return{build:function(e,t){var i=function(){l.apply(this,arguments),this.register(e),this.name=t||""};return i.prototype=l.prototype,i},getElementRenderer:function(e,t){if(t.qtiClass===e.qtiClass){t.getRenderer()}}}}),define("taoQtiItem/qtiDefaultRenderer/renderers/config",[],function(){return{name:"defaultRenderer",locations:{_container:"taoQtiItem/qtiDefaultRenderer/renderers/Container",assessmentItem:"taoQtiItem/qtiDefaultRenderer/renderers/Item",stylesheet:"taoQtiItem/qtiDefaultRenderer/renderers/Stylesheet",outcomeDeclaration:"taoQtiItem/qtiDefaultRenderer/renderers/OutcomeDeclaration",responseDeclaration:"taoQtiItem/qtiDefaultRenderer/renderers/ResponseDeclaration",responseProcessing:"taoQtiItem/qtiDefaultRenderer/renderers/ResponseProcessing",math:"taoQtiItem/qtiDefaultRenderer/renderers/Math",object:"taoQtiItem/qtiDefaultRenderer/renderers/Object",modalFeedback:"taoQtiItem/qtiDefaultRenderer/renderers/ModalFeedback",rubricBlock:"taoQtiItem/qtiDefaultRenderer/renderers/RubricBlock",associateInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/AssociateInteraction",choiceInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/ChoiceInteraction",extendedTextInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/ExtendedTextInteraction",gapMatchInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/GapMatchInteraction",graphicAssociateInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/GraphicAssociateInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/GraphicGapMatchInteraction",graphicOrderInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/GraphicOrderInteraction",hotspotInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/HotspotInteraction",hottextInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/HottextInteraction",inlineChoiceInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/InlineChoiceInteraction",matchInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/MatchInteraction",mediaInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/MediaInteraction",orderInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/OrderInteraction",selectPointInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/SelectPointInteraction",sliderInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/SliderInteraction",textEntryInteraction:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/TextEntryInteraction",prompt:"taoQtiItem/qtiDefaultRenderer/renderers/interactions/Prompt",associableHotspot:"taoQtiItem/qtiDefaultRenderer/renderers/choices/AssociableHotspot",gap:"taoQtiItem/qtiDefaultRenderer/renderers/choices/Gap",gapImg:"taoQtiItem/qtiDefaultRenderer/renderers/choices/GapImg",gapText:"taoQtiItem/qtiDefaultRenderer/renderers/choices/GapText",hotspotChoice:"taoQtiItem/qtiDefaultRenderer/renderers/choices/HotspotChoice",hottext:"taoQtiItem/qtiDefaultRenderer/renderers/choices/Hottext",inlineChoice:"taoQtiItem/qtiDefaultRenderer/renderers/choices/InlineChoice",simpleAssociableChoice:"taoQtiItem/qtiDefaultRenderer/renderers/choices/SimpleAssociableChoice",simpleChoice:"taoQtiItem/qtiDefaultRenderer/renderers/choices/SimpleChoice"}}
}),define("taoQtiItem/qtiCommonRenderer/renderers/config",["lodash","taoQtiItem/qtiDefaultRenderer/renderers/config"],function(e,t){var i=e.extend(e.clone(t.locations),{assessmentItem:"taoQtiItem/qtiCommonRenderer/renderers/Item",_container:"taoQtiItem/qtiCommonRenderer/renderers/Container",_simpleFeedbackRule:!1,stylesheet:"taoQtiItem/qtiCommonRenderer/renderers/Stylesheet",img:"taoQtiItem/qtiCommonRenderer/renderers/Img",rubricBlock:"taoQtiItem/qtiCommonRenderer/renderers/RubricBlock",modalFeedback:"taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback",prompt:"taoQtiItem/qtiCommonRenderer/renderers/interactions/Prompt",choiceInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction",extendedTextInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction",orderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction",associateInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction",matchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction",textEntryInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction",inlineChoiceInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction","simpleChoice.choiceInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction","simpleChoice.orderInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction",hottext:"taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext",gap:"taoQtiItem/qtiCommonRenderer/renderers/choices/Gap",gapText:"taoQtiItem/qtiCommonRenderer/renderers/choices/GapText","simpleAssociableChoice.matchInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction","simpleAssociableChoice.associateInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction",sliderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction",inlineChoice:"taoQtiItem/qtiCommonRenderer/renderers/choices/InlineChoice",hottextInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction",hotspotInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction",gapMatchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction",selectPointInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction",graphicOrderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction",mediaInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction",uploadInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction",gapImg:"taoQtiItem/qtiCommonRenderer/renderers/choices/GapImg",graphicAssociateInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction"});return{name:"commonRenderer",locations:i}}),define("taoQtiItem/qtiCreator/renderers/config",["lodash","taoQtiItem/qtiCommonRenderer/renderers/config"],function(e,t){var i=e.defaults({_container:"taoQtiItem/qtiCreator/renderers/Container",assessmentItem:"taoQtiItem/qtiCreator/renderers/Item",rubricBlock:"taoQtiItem/qtiCreator/renderers/RubricBlock",img:"taoQtiItem/qtiCreator/renderers/Img",math:"taoQtiItem/qtiCreator/renderers/Math",modalFeedback:"taoQtiItem/qtiCreator/renderers/ModalFeedback",choiceInteraction:"taoQtiItem/qtiCreator/renderers/interactions/ChoiceInteraction",orderInteraction:"taoQtiItem/qtiCreator/renderers/interactions/OrderInteraction",matchInteraction:"taoQtiItem/qtiCreator/renderers/interactions/MatchInteraction",associateInteraction:"taoQtiItem/qtiCreator/renderers/interactions/AssociateInteraction",inlineChoiceInteraction:"taoQtiItem/qtiCreator/renderers/interactions/InlineChoiceInteraction",textEntryInteraction:"taoQtiItem/qtiCreator/renderers/interactions/TextEntryInteraction",hotspotInteraction:"taoQtiItem/qtiCreator/renderers/interactions/HotspotInteraction",selectPointInteraction:"taoQtiItem/qtiCreator/renderers/interactions/SelectPointInteraction",graphicOrderInteraction:"taoQtiItem/qtiCreator/renderers/interactions/GraphicOrderInteraction",graphicAssociateInteraction:"taoQtiItem/qtiCreator/renderers/interactions/GraphicAssociateInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiCreator/renderers/interactions/GraphicGapMatchInteraction",mediaInteraction:"taoQtiItem/qtiCreator/renderers/interactions/MediaInteraction",uploadInteraction:"taoQtiItem/qtiCreator/renderers/interactions/UploadInteraction","simpleChoice.choiceInteraction":"taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.ChoiceInteraction","simpleChoice.orderInteraction":"taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.OrderInteraction","simpleAssociableChoice.associateInteraction":"taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.AssociateInteraction","simpleAssociableChoice.matchInteraction":"taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.MatchInteraction"},t.locations);return{name:"creatorRenderer",locations:i}}),define("taoQtiItem/qtiCreator/renderers/Renderer",["taoQtiItem/qtiRunner/core/Renderer","taoQtiItem/qtiCreator/renderers/config"],function(e,t){return e.build(t.locations,t.name)}),define("taoQtiItem/qtiCreator/helper/creatorRenderer",["taoQtiItem/qtiCreator/renderers/Renderer"],function(e){var t=new e({baseUrl:"",shuffleChoices:!1,interactionOptionForm:$("#item-editor-interaction-property-bar .panel"),choiceOptionForm:$("#item-editor-choice-property-bar .panel"),responseOptionForm:$("#item-editor-response-property-bar .panel"),bodyElementOptionForm:$("#item-editor-body-element-property-bar .panel")});return{get:function(){return t},setOption:function(e,i){t.setOption(e,i)}}}),define("json!taoQtiItem/qtiCreator/editor/resources/font-stacks.json",function(){return{"sans-serif":['Arial, "Helvetica Neue", Helvetica, sans-serif','"Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, "AppleGothic", sans-serif','Calibri, Candara, Segoe, "Segoe UI", Optima, Arial, sans-serif','Candara, Calibri, Segoe, "Segoe UI", Optima, Arial, sans-serif','"Century Gothic", CenturyGothic, AppleGothic, sans-serif','Corbel, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "DejaVu Sans", "Bitstream Vera Sans", "Liberation Sans", Verdana, "Verdana Ref", sans-serif','"Franklin Gothic Medium", "Franklin Gothic", "ITC Franklin Gothic", Arial, sans-serif','Frutiger, "Frutiger Linotype", Univers, Calibri, "Gill Sans", "Gill Sans MT", "Myriad Pro", Myriad, "DejaVu Sans Condensed", "Liberation Sans", "Nimbus Sans L", Tahoma, Geneva, "Helvetica Neue", Helvetica, Arial, sans-serif','Futura, "Century Gothic", AppleGothic, "Trebuchet MS", sans-serif','Geneva, Verdana, "Lucida Sans", "Lucida Grande", "Lucida Sans Unicode", sans-serif','"Gill Sans", "Gill Sans MT", Calibri, sans-serif','"Helvetica Neue", Helvetica, Arial, sans-serif','Impact, Haettenschweiler, "Franklin Gothic Bold", Charcoal, "Helvetica Inserat", "Bitstream Vera Sans Bold", "Arial Black", sans-serif','"Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Verdana, sans-serif','Optima, Segoe, "Segoe UI", Candara, Calibri, Arial, sans-serif','"Segoe UI", Candara, "Bitstream Vera Sans", "DejaVu Sans", "Bitstream Vera Sans", "Trebuchet MS", Verdana, "Verdana Ref", sans-serif',"Tahoma, Verdana, Segoe, sans-serif",'"Trebuchet MS", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Tahoma, sans-serif',"Verdana, Geneva, Tahoma, sans-serif"],serif:['Baskerville, "Baskerville Old Face", "Hoefler Text", Garamond, "Times New Roman", serif','"Big Caslon", "Book Antiqua", "Palatino Linotype", Georgia, serif','"Bodoni MT", Didot, "Didot LT STD", "Hoefler Text", Garamond, "Times New Roman", serif','"Book Antiqua", Palatino, "Palatino Linotype", "Palatino LT STD", Georgia, serif','"Calisto MT", "Bookman Old Style", Bookman, "Goudy Old Style", Garamond, "Hoefler Text", "Bitstream Charter", Georgia, serif','Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif','Constantia, "Lucida Bright", Lucidabright, "Lucida Serif", Lucida, "DejaVu Serif", "Bitstream Vera Serif", "Liberation Serif", Georgia, serif','Didot, "Didot LT STD", "Hoefler Text", Garamond, "Times New Roman", serif','Garamond, Baskerville, "Baskerville Old Face", "Hoefler Text", "Times New Roman", serif','Georgia, Palatino," Palatino Linotype", Times, "Times New Roman", serif','"Goudy Old Style", Garamond, "Big Caslon", "Times New Roman", serif','"Hoefler Text", "Baskerville old face", Garamond, "Times New Roman", serif','"Lucida Bright", Georgia, serif','"Palatino Linotype", Palatino, Palladio, "URW Palladio L", "Book Antiqua", Baskerville, "Bookman Old Style", "Bitstream Charter", "Nimbus Roman No9 L", Garamond, "Apple Garamond", "ITC Garamond Narrow", "New Century Schoolbook", "Century Schoolbook", "Century Schoolbook L", Georgia, serif','Perpetua, Baskerville, "Big Caslon", "Palatino Linotype", Palatino, "URW Palladio L", "Nimbus Roman No9 L", serif','Rockwell, "Courier Bold", Courier, Georgia, Times, "Times New Roman", serif','"Times New Roman", TimesNewRoman, Times, Baskerville, Georgia, serif'],monospace:['"Andale Mono", AndaleMono, monospace','Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace','"Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace','"Lucida Console", "Lucida Sans Typewriter", Monaco, "Bitstream Vera Sans Mono", monospace','Monaco, Consolas, "Lucida Console", monospace','"Rockwell Extra Bold", "Rockwell Bold", monospace']}}),define("tpl!taoQtiItem/qtiCreator/tpl/toolbars/cssToggler",["handlebars"],function(e){return e.template(function(e,t,i,n,r){function o(e,t){var n,r,o="";return o+='\n<li data-css-res="',(r=i.path)?n=r.call(e,{hash:{},data:t}):(r=e&&e.path,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'">\n    <span class="icon-preview style-sheet-toggler" title="',(r=i.title)?n=r.call(e,{hash:{},data:t}):(r=e&&e.title,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'"></span>\n    <span class="file-label truncate" title="',(r=i.editLabelTxt)?n=r.call(e,{hash:{},data:t}):(r=e&&e.editLabelTxt,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'">',(r=i.label)?n=r.call(e,{hash:{},data:t}):(r=e&&e.label,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'</span>\n    <input type="text" class="style-sheet-label-editor" value="',(r=i.label)?n=r.call(e,{hash:{},data:t}):(r=e&&e.label,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'">\n    <span class="icon-bin" title="',(r=i.deleteTxt)?n=r.call(e,{hash:{},data:t}):(r=e&&e.deleteTxt,n=typeof r===s?r.call(e,{hash:{},data:t}):r),o+=c(n)+'" data-role="css-delete"></span>\n</li>\n'}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers),r=r||{};var a,s="function",c=this.escapeExpression,l=this;return a=i.each.call(t,t&&t.stylesheets,{hash:{},inverse:l.noop,fn:l.program(1,o,r),data:r}),a||0===a?a:""})}),function(e){e.extend({fileDownload:function(t,i){function n(){if(-1!=document.cookie.indexOf(c.cookieName+"="+c.cookieValue)){p.onSuccess(t);var i=new Date(1e3);return document.cookie=c.cookieName+"=; expires="+i.toUTCString()+"; path="+c.cookiePath,void o(!1)}if(v||g)try{var a;if(a=v?v.document:r(g),a&&null!=a.body&&a.body.innerHTML.length>0){var s=!0;if(I&&I.length>0){var l=e(a.body).contents().first();l.length>0&&l[0]===I[0]&&(s=!1)}if(s)return p.onFail(a.body.innerHTML,t),void o(!0)}}catch(d){return p.onFail("",t),void o(!0)}setTimeout(n,c.checkInterval)}function r(e){var t=e[0].contentWindow||e[0].contentDocument;return t.document&&(t=t.document),t}function o(e){setTimeout(function(){v&&(u&&v.close(),d&&(e?(v.focus(),v.close()):v.focus()))},0)}function a(e){return e.replace(/&/gm,"&amp;").replace(/\n/gm,"&#10;").replace(/\r/gm,"&#13;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&apos;")}var s=function(){alert("A file download error has occurred, please try again.")},c=e.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:!0},successCallback:function(){},failCallback:s,httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},i),l=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),d=!1,u=!1,h=!1;/ip(ad|hone|od)/.test(l)?d=!0:-1!=l.indexOf("android")?u=!0:h=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(l.substr(0,4));var f=c.httpMethod.toUpperCase();if(u&&"GET"!=f)return void(e().dialog?e("<div>").html(c.androidPostUnsupportedMessageHtml).dialog(c.dialogOptions):alert(c.androidPostUnsupportedMessageHtml));var m=null;c.preparingMessageHtml&&(m=e("<div>").html(c.preparingMessageHtml).dialog(c.dialogOptions));var p={onSuccess:function(e){m&&m.dialog("close"),c.successCallback(e)},onFail:function(t,i){m&&m.dialog("close"),c.failMessageHtml?(e("<div>").html(c.failMessageHtml).dialog(c.dialogOptions),c.failCallback!=s&&c.failCallback(t,i)):c.failCallback(t,i)}};null!==c.data&&"string"!=typeof c.data&&(c.data=e.param(c.data));var g,v,b,I;if("GET"===f){if(null!==c.data){var y=t.indexOf("?");-1!=y?"&"!==t.substring(t.length-1)&&(t+="&"):t+="?",t+=c.data}d||u?(v=window.open(t),v.document.title=c.popupWindowTitle,window.focus()):h?window.location(t):g=e("<iframe>").hide().attr("src",t).appendTo("body")}else{var C="";null!==c.data&&e.each(c.data.replace(/\+/g," ").split("&"),function(){var e=this.split("="),t=c.encodeHTMLEntities?a(decodeURIComponent(e[0])):decodeURIComponent(e[0]);if(t){var i=e[1]||"";i=c.encodeHTMLEntities?a(decodeURIComponent(e[1])):decodeURIComponent(e[1]),C+='<input type="hidden" name="'+t+'" value="'+i+'" />'}}),h?(I=e("<form>").appendTo("body"),I.hide().attr("method",c.httpMethod).attr("action",t).html(C)):(d?(v=window.open("about:blank"),v.document.title=c.popupWindowTitle,b=v.document,window.focus()):(g=e("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body"),b=r(g)),b.write("<html><head></head><body><form method='"+c.httpMethod+"' action='"+t+"'>"+C+"</form>"+c.popupWindowTitle+"</body></html>"),I=e(b).find("form")),I.submit()}setTimeout(n,c.checkInterval)}})}(jQuery),define("lib/jquery.fileDownload",function(){}),define("taoQtiItem/qtiCreator/editor/styleEditor/styleEditor",["jquery","lodash","helpers","i18n","tpl!taoQtiItem/qtiCreator/tpl/toolbars/cssToggler","lib/jquery.fileDownload"],function(e,t,i,n,r){"use strict";var o,a=function(e){return i._url(e,"QtiCssAuthoring","taoQtiItem")},s=function(e){return e.substring(e.lastIndexOf("/")+1)},c=function(e,i){var c,l={},d=function(){var t=e("<style>",{id:"item-editor-user-styles"});return e("head").append(t),t}(),u={title:n("Disable this style sheet temporarily"),deleteTxt:n("Delete this style sheet"),editLabelTxt:n("Edit style sheet label"),listing:e("#style-sheet-toggler")},h="",f=function(){var e,i,n,r,o="";for(e in l)if(l.hasOwnProperty(e)){o+=e+"{";for(i in l[e])if(l[e].hasOwnProperty(i))if(t.isPlainObject(l[e][i]))for(n in l[e][i]){o+=i+"{";for(r in l[e][i])o+=r+":"+l[e][i][n]+";";o+="}"}else o+=i+":"+l[e][i]+";";o+="}\n"}d.text(o)},m=function(e,i,n){l[e]=l[e]||{},n?l[e][i]=n:(delete l[e][i],0===t.size(l[e])&&delete l[e]),f()},p=function(){d.text("")},g=function(){t.isEmpty(l),b(),e.post(a("save"),t.extend({},o,{cssJson:JSON.stringify(l)}))};e(document).on("itemsave.qtiEdit",g);var v=function(){b(),e.fileDownload(a("download"),{preparingMessageHtml:n("We are preparing your CSS, please wait..."),failMessageHtml:n("There was a problem downloading your CSS, please try again."),successCallback:function(){},httpMethod:"POST",data:t.extend({},o,{cssJson:JSON.stringify(l)})})},b=function(){if(!o)throw new Error("Missing itemConfig, did you call styleEditor.init()?");return!0},I=function(i){var n,o,a,l=[];t.isString(i)&&(i=c.createStyleSheet(i)),n=s(i.attr("href")),o=e(i.render()),d.before(o),l.push({path:i.attr("href"),label:i.attr("title")||n,title:u.title,deleteTxt:u.deleteTxt,editLabelTxt:u.editLabelTxt}),a=e(r({stylesheets:l})),u.listing.append(a)},y=function(){var t;for(var i in c.stylesheets)c.stylesheets.hasOwnProperty(i)&&(t=c.stylesheets[i],"tao-user-styles.css"!==s(t.attr("href"))?I(c.stylesheets[i]):h=t.attr("href"));e('[data-role="css-download"]').on("click",v),h||c.createStyleSheet("style/custom/tao-user-styles.css")},C=function(){return c},w=function(n,r){c=n,o=r;var s=a("load")+"?",d=e("#item-editor-item-resizer").data("target");y(),c.data("responsive",!0),h&&(s+=e.param(t.extend({},o,{stylesheetUri:h})),require(["json!"+s],function(t){l=t,f(),c.data("responsive",l[d]&&l[d].width),e(i).trigger("customcssloaded.styleeditor",l)})),e(i).on("itemsave.qtiEdit",g)};return{apply:m,save:g,erase:p,init:w,create:f,getItem:C,addStylesheet:I}}(e,document);return c}),define("taoQtiItem/qtiCreator/editor/styleEditor/fontSelector",["jquery","json!taoQtiItem/qtiCreator/editor/resources/font-stacks.json","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor","i18n","select2"],function(e,t,i,n){"use strict";var r=function(){var r,o,a,s,c=e("select#item-editor-font-selector"),l=c.data("target"),d=e(l),u=function(e){return e.replace(/"/g,"'").replace(/, /g,",")},h=function(e){return e.substring(0,e.indexOf(",")).replace(/'/g,"")},f=c.parent().find('[data-role="font-selector-reset"]'),m=0,p=function(e){return e=e.replace(/-/g," "),(e+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()})},g=function(t){var i=t.element;return t.id?'<span style="font-size: 12px;'+e(i).attr("style")+'">'+t.text+"</span>":t.text},v=function(){i.apply(l,"font-family"),c.select2("val",d.css("font-family"))};c.append('<option value="">'+n("Default")+"</option>");for(r in t)if(t.hasOwnProperty(r)){for(o=e("<optgroup>",{label:p(r)}),s=t[r].length,m=0;s>m;m++)t[r][m]=u(t[r][m]),a=e("<option>",{value:t[r][m],text:h(t[r][m])}).css({fontFamily:t[r][m]}),o.append(a);c.append(o)}f.on("click",v),c.select2({formatResult:g,formatSelection:g,width:"resolve"}),e(document).on("customcssloaded.styleeditor",function(e,t){t[l]&&t[l]["font-family"]&&c.select2("val",t[l]["font-family"])}),c.on("change",function(){i.apply(l,"font-family",e(this).val())})};return r}),jQuery.fn.farbtastic=function(e){return $.farbtastic(this,e),this},jQuery.farbtastic=function(e,t){if(e.length){var e=$(e).get(0);return e.farbtastic||(e.farbtastic=new jQuery._farbtastic(e,t))}},jQuery._farbtastic=function(e,t){var i=this,n=$("<div>",{"class":"farbtastic"}),r=$("<div>",{"class":"color"}),o=$("<div>",{"class":"wheel"}),a=$("<div>",{"class":"overlay"}),s=$("<div>",{"class":"h-marker marker"}),c=$("<div>",{"class":"sl-marker marker"});e=$(e),$(n).append(r),$(n).append(o),$(n).append(a),$(n).append(s),$(n).append(c),e.append(n),i.wheel=o.get(0),i.radius=70,i.square=a.width(),i.width=n.width(),i.linkTo=function(e){return"object"==typeof i.callback&&$(i.callback).unbind("keyup",i.updateValue),i.color=null,"function"==typeof e?i.callback=e:("object"==typeof e||"string"==typeof e)&&(i.callback=$(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value)),this},i.updateValue=function(){this.value&&this.value!=i.color&&i.setColor(this.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!=e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var t,n,r=e.target||e.srcElement,o=i.wheel;if("undefined"!=typeof e.offsetX){for(var a={x:e.offsetX,y:e.offsetY},s=r;s;)s.mouseX=a.x,s.mouseY=a.y,a.x+=s.offsetLeft,a.y+=s.offsetTop,s=s.offsetParent;for(var s=o,c={x:0,y:0};s;){if("undefined"!=typeof s.mouseX){t=s.mouseX-c.x,n=s.mouseY-c.y;break}c.x+=s.offsetLeft,c.y+=s.offsetTop,s=s.offsetParent}for(s=r;s;)s.mouseX=void 0,s.mouseY=void 0,s=s.offsetParent}else{var a=i.absolutePosition(o);t=(e.pageX||0*(e.clientX+$("html").get(0).scrollLeft))-a.x,n=(e.pageY||0*(e.clientY+$("html").get(0).scrollTop))-a.y}return{x:t-i.width/2,y:n-i.width/2}},i.mousedown=function(e){document.dragging||($(document).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),document.dragging=!0);var t=i.widgetCoords(e);return i.circleDrag=2*Math.max(Math.abs(t.x),Math.abs(t.y))>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e);if(i.circleDrag){var n=Math.atan2(t.x,-t.y)/6.28;0>n&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])}else{var r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),o=Math.max(0,Math.min(1,-(t.y/i.square)+.5));i.setHSL([i.hsl[0],r,o])}return!1},i.mouseup=function(){$(document).unbind("mousemove",i.mousemove),$(document).unbind("mouseup",i.mouseup),document.dragging=!1},i.updateDisplay=function(){var t=6.28*i.hsl[0];$(".h-marker",n).css({left:Math.round(Math.sin(t)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(t)*i.radius+i.width/2)+"px"}),$(".sl-marker",n).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),$(".color",n).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),"object"==typeof i.callback?($(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),$(i.callback).each(function(){this.value&&this.value!=i.color&&(this.value=i.color)})):"function"==typeof i.callback&&i.callback.call(i,i.color),e.trigger("colorchange.farbtastic",[i.color])},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop};if(e.offsetParent){var n=i.absolutePosition(e.offsetParent);t.x+=n.x,t.y+=n.y}return t},i.pack=function(e){var t=Math.round(255*e[0]),i=Math.round(255*e[1]),n=Math.round(255*e[2]);return"#"+(16>t?"0":"")+t.toString(16)+(16>i?"0":"")+i.toString(16)+(16>n?"0":"")+n.toString(16)},i.unpack=function(e){return 7==e.length?[parseInt("0x"+e.substring(1,3))/255,parseInt("0x"+e.substring(3,5))/255,parseInt("0x"+e.substring(5,7))/255]:4==e.length?[parseInt("0x"+e.substring(1,2))/15,parseInt("0x"+e.substring(2,3))/15,parseInt("0x"+e.substring(3,4))/15]:void 0},i.HSLToRGB=function(e){var t,i,n=e[0],r=e[1],o=e[2];return i=.5>=o?o*(r+1):o+r-o*r,t=2*o-i,[this.hueToRGB(t,i,n+.33333),this.hueToRGB(t,i,n),this.hueToRGB(t,i,n-.33333)]},i.hueToRGB=function(e,t,i){return i=0>i?i+1:i>1?i-1:i,1>6*i?e+(t-e)*i*6:1>2*i?t:2>3*i?e+(t-e)*(.66666-i)*6:e},i.RGBToHSL=function(e){var t,i,n,r,o,a,s=e[0],c=e[1],l=e[2];return t=Math.min(s,Math.min(c,l)),i=Math.max(s,Math.max(c,l)),n=i-t,a=(t+i)/2,o=0,a>0&&1>a&&(o=n/(.5>a?2*a:2-2*a)),r=0,n>0&&(i==s&&i!=c&&(r+=(c-l)/n),i==c&&i!=l&&(r+=2+(l-s)/n),i==l&&i!=s&&(r+=4+(s-c)/n),r/=6),[r,o,a]},$("*",n).mousedown(i.mousedown),i.setColor("#123456"),t&&i.linkTo(t)},define("taoQtiItem/qtiCreator/editor/styleEditor/farbtastic/farbtastic",function(){}),define("taoQtiItem/qtiCreator/editor/styleEditor/colorSelector",["jquery","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor","taoQtiItem/qtiCreator/editor/styleEditor/farbtastic/farbtastic"],function(e,t){"use strict";function i(e){if("#"===e.substr(0,1))return e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e),i=("0"+parseInt(t[2],10).toString(16)).slice(-2),n=("0"+parseInt(t[3],10).toString(16)).slice(-2),r=("0"+parseInt(t[4],10).toString(16)).slice(-2);return"#"+i+n+r}var n=function(){var n,r=e("#item-editor-color-picker"),o=r.data("target"),a=r.find(".color-picker"),s=r.find("#color-picker-container"),c=r.find("#color-picker-title"),l=r.find("#color-picker-input"),d=r.find(".reset-button"),u=r.find(".color-trigger"),h="color",f=e(document),m=function(){t.apply(o,e(this).data("value")),g()},p=function(e,t){c.text(t.parent().find("label").text())},g=function(){u.each(function(){var t=e(this),i=e(t.data("target"));t.css("background-color",i.css(t.data("value")))})};n=e.farbtastic(a).linkTo(l),a.on("colorchange.farbtastic",function(e,i){t.apply(a.prop("target"),h,i),g()}),g(),u.on("click",function(){var t=e(this);e(t.data("target")).length&&(a.prop("target",t.data("target")),s.hide(),h=t.data("value"),p(h,t),n.setColor(i(t.css("background-color"))),s.show())}),f.on("mouseup",function(e){return e.target.className.indexOf("closer")>-1?(s.hide(),!1):s.is(e.target)||0!==s.has(e.target).length?void 0:(s.hide(),!1)}),f.on("keyup",function(e){return 27===e.keyCode?(s.hide(),!1):void 0}),d.on("click",m),f.on("customcssloaded.styleeditor",m)};return n}),define("taoQtiItem/qtiCreator/editor/styleEditor/fontSizeChanger",["jquery","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor"],function(e,t){"use strict";var i=function(){var i=e("#item-editor-font-size-changer"),n=i.data("target"),r=n+" .item-title",o=n+" .qti-itemBody",a=parseInt(e(r).css("font-size"),10),s=parseInt(e(o).css("font-size"),10),c=a-s,l=i.parents(".reset-group").find('[data-role="font-size-reset"]'),d=e("#item-editor-font-size-text"),u=function(){var e=s+c;t.apply(r,"font-size",e.toString()+"px"),t.apply(o,"font-size",s.toString()+"px")};i.find("a").on("click",function(t){if(t.preventDefault(),"reduce"===e(this).data("action")){if(10>=s)return;s--}else s++;u(),d.val(s),e(this).parent().blur()}),d.on("keydown",function(e){var t=e.keyCode;return _.contains([8,37,39,46],t)||t>=48&&57>=t||t>=96&&105>=t}),d.on("blur",function(){s=parseInt(this.value,10),u()}),d.on("keydown",function(e){var t=e.keyCode;13===t&&d.trigger("blur")}),l.on("click",function(){d.val(""),t.apply(r,"font-size"),t.apply(o,"font-size")}),e(document).on("customcssloaded.styleeditor",function(){d.val(parseInt(e(o).css("font-size"),10)),d.trigger("blur")})};return i}),function(e){function t(e){throw new RangeError("noUiSlider: "+e)}function i(e,i,n){(e[i]||e[n])&&e[i]===e[n]&&t("(Link) '"+i+"' can't match '"+n+"'.'")}function n(e){return Math.max(Math.min(e,100),0)}function r(e,t){return Math.round(e/t)*t}function o(e,t){return 100/(t-e)}function a(e,t){return typeof e==typeof t}function s(t){return t instanceof e||e.zepto&&e.zepto.isZ(t)}function c(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function l(t){return e.isArray(t)?t:[t]}function d(e,t,i){e.addClass(t),setTimeout(function(){e.removeClass(t)},i)}function u(e,t){return 100*t/(e[1]-e[0])}function h(e,t){return u(e,e[0]<0?t+Math.abs(e[0]):t-e[0])}function f(e,t){return t*(e[1]-e[0])/100+e[0]}function m(e,t){if(t>=e.xVal.slice(-1)[0])return 100;for(var i,n,r,a,s=1;t>=e.xVal[s];)s++;return i=e.xVal[s-1],n=e.xVal[s],r=e.xPct[s-1],a=e.xPct[s],r+h([i,n],t)/o(r,a)}function p(e,t){if(t>=100)return e.xVal.slice(-1)[0];for(var i,n,r,a,s=1;t>=e.xPct[s];)s++;return i=e.xVal[s-1],n=e.xVal[s],r=e.xPct[s-1],a=e.xPct[s],f([i,n],(t-r)*o(r,a))}function g(e,t){for(var i,n,o=1;t>=e.xPct[o];)o++;return e.snap?(i=e.xPct[o-1],n=e.xPct[o],t-i>(n-i)/2?n:i):e.xSteps[o-1]?e.xPct[o-1]+r(t-e.xPct[o-1],e.xSteps[o-1]):t}function v(e){e.preventDefault();var t,i,n=0===e.type.indexOf("touch"),r=0===e.type.indexOf("mouse"),o=0===e.type.indexOf("pointer"),a=e;return 0===e.type.indexOf("MSPointer")&&(o=!0),e.originalEvent&&(e=e.originalEvent),n&&(t=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY),(r||o)&&(o||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),t=e.clientX+window.pageXOffset,i=e.clientY+window.pageYOffset),a.points=[t,i],a.cursor=r,a}function b(n){void 0===n&&(n={}),"object"!=typeof n&&t("(Format) 'format' option must be an object.");var r={};e(W).each(function(e,i){void 0===n[i]?r[i]=$[e]:a(n[i],$[e])?("decimals"===i&&(n[i]<0||n[i]>7)&&t("(Format) 'format.decimals' option must be between 0 and 7."),r[i]=n[i]):t("(Format) 'format."+i+"' must be a "+typeof $[e]+".")}),i(r,"mark","thousand"),i(r,"prefix","negative"),i(r,"prefix","negativeBefore"),this.settings=r}function I(t,i){if(!(this instanceof I))throw new Error("Link: Don't use Link as a function. Use the 'new' keyword.");if(!t)throw new RangeError("Link: missing parameters.");this.formatting=t.format||{},this.update=!i;var n=this,r=t.target||function(){},o=t.method,a="string"==typeof r&&0===r.indexOf("-tooltip-"),c="string"==typeof r&&0!==r.indexOf("-"),l="function"==typeof r,d=s(r),u=d&&r.is("input, select, textarea"),h=d&&"function"==typeof o,f=d&&"string"==typeof o&&r[o];if(a)return this.method=o||"html",void(this.el=e(r.replace("-tooltip-","")||"<div/>")[0]);if(c)return this.method="val",this.el=document.createElement("input"),this.el.name=r,void(this.el.type="hidden");if(l)return this.target=!1,void(this.method=r);if(d){if(o&&(h||f))return this.target=r,void(this.method=o);if(!o&&u)return this.method="val",this.target=r,void this.target.on("change",function(t){function i(e,t,i){return[i?e:t,i?t:e]}var r=i(null,e(t.target).val(),n.N);n.obj.val(r,{link:n})});if(!o&&!u)return this.method="html",void(this.target=r)}throw new RangeError("Link: Invalid Link.")}function y(e,i){c(i)||t("'step' is not numeric."),e.xSteps[0]=i}function C(i,n){("object"!=typeof n||e.isArray(n))&&t("'range' is not an object."),e.each(n,function(n,r){var o;"number"==typeof r&&(r=[r]),e.isArray(r)||t("'range' contains invalid value."),o="min"===n?0:"max"===n?100:parseFloat(n),c(o)&&c(r[0])||t("'range' value isn't numeric."),i.xPct.push(o),i.xVal.push(r[0]),o?i.xSteps.push(isNaN(r[1])?!1:r[1]):isNaN(r[1])||(i.xSteps[0]=r[1])}),e.each(i.xSteps,function(e,t){return t?void(i.xSteps[e]=u([i.xVal[e],i.xVal[e+1]],t)/o(i.xPct[e],i.xPct[e+1])):!0})}function w(i,n){"number"==typeof n&&(n=[n]),(!e.isArray(n)||!n.length||n.length>2)&&t("'start' option is incorrect."),i.handles=n.length,i.start=n}function q(e,i){e.snap=i,"boolean"!=typeof i&&t("'snap' option must be a boolean.")}function x(e,i){"lower"===i&&1===e.handles?e.connect=1:"upper"===i&&1===e.handles?e.connect=2:i===!0&&2===e.handles?e.connect=3:i===!1?e.connect=0:t("'connect' option was doesn't match handle count.")
}function k(e,i){switch(i){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:t("'orientation' option is invalid.")}}function Q(e,i){e.xPct.length>2&&t("'margin' option is only supported on linear sliders."),e.margin=u(e.xVal,i),c(i)||t("'margin' option must be numeric.")}function R(e,i){switch(i){case"ltr":e.dir=0;break;case"rtl":e.dir=1,e.connect=[0,2,1,3][e.connect];break;default:t("'direction' option was not recognized.")}}function S(e,i){"string"!=typeof i&&t("'behaviour' must be a string containing options.");var n=i.indexOf("tap")>=0,r=i.indexOf("extend")>=0,o=i.indexOf("drag")>=0,a=i.indexOf("fixed")>=0,s=i.indexOf("snap")>=0;e.events={tap:n||s,extend:r,drag:o,fixed:a,snap:s}}function E(i,n,r){i.ser=[n.lower,n.upper],i.formatting=new b(n.format),e.each(i.ser,function(i,o){e.isArray(o)||t("'serialization."+(i?"upper":"lower")+"' must be an array."),e.each(o,function(){this instanceof I||t("'serialization."+(i?"upper":"lower")+"' can only contain Link instances."),this.N=i,this.obj=r,this.scope=this.scope||r,this.formatting=new b(e.extend({},n.format,this.formatting))})}),i.dir&&i.handles>1&&i.ser.reverse()}function A(i,n){var r,o={xPct:[],xVal:[],xSteps:[!1],margin:0};return r={step:{r:!1,t:y},range:{r:!0,t:C},start:{r:!0,t:w},snap:{r:!1,t:q},connect:{r:!0,t:x},orientation:{r:!1,t:k},margin:{r:!1,t:Q},direction:{r:!0,t:R},behaviour:{r:!0,t:S},serialization:{r:!0,t:E}},i=e.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},i),i.serialization=e.extend({lower:[],upper:[],format:{}},i.serialization),e.each(r,function(e,r){if(void 0===i[e]){if(!r.r)return!0;t("'"+e+"' is required.")}r.t(o,i[e],n)}),o.style=o.ort?"top":"left",o}function M(t,i){var n=e("<div><div/></div>").addClass(_[2]),r=["-lower","-upper"];return t.dir&&r.reverse(),n.children().addClass(_[3]+" "+_[3]+r[i]),n}function T(t,i){return i.el&&(i=new I({target:e(i.el).clone().appendTo(t),method:i.method,format:i.formatting},!0)),i}function D(e,t,i){var n,r=[];for(r.push(new I({format:i},!0)),n=0;n<e.length;n++)r.push(T(t,e[n]));return r}function O(e,t){var i,n=[];for(i=0;i<e.handles;i++)n[i]=D(e.ser[i],t[i].children(),e.formatting);return n}function P(e,t,i){switch(e){case 1:t.addClass(_[7]),i[0].addClass(_[6]);break;case 3:i[1].addClass(_[6]);case 2:i[0].addClass(_[7]);case 0:t.addClass(_[6])}}function F(e,t){var i,n=[];for(i=0;i<e.handles;i++)n.push(M(e,i).appendTo(t));return n}function H(t,i){return i.addClass([_[0],_[8+t.dir],_[4+t.ort]].join(" ")),e("<div/>").appendTo(i).addClass(_[1])}function j(t,i,r){function o(){return C[["width","height"][i.ort]]()}function a(e){var t,i=[x.val()];for(t=0;t<e.length;t++)x.trigger(e[t],i)}function s(t,r,o){var a=t[0]!==q[0][0]?1:0,s=k[0]+i.margin,c=k[1]-i.margin;return o&&q.length>1&&(r=a?Math.max(r,s):Math.min(r,c)),100>r&&(r=g(i,r)),r=n(parseFloat(r.toFixed(7))),r===k[a]?1===q.length?!1:r===s||r===c?0:!1:(t.css(i.style,r+"%"),t.is(":first-child")&&t.toggleClass(_[17],r>50),k[a]=r,i.dir&&(r=100-r),e(w[a]).each(function(){this.write(i,r,t.children(),x)}),!0)}function c(e,t,i){var r=e+t[0],o=e+t[1];return i?(0>r&&(o+=Math.abs(r)),o>100&&(r-=o-100),[n(r),n(o)]):[r,o]}function l(e,t,i){i||d(x,_[14],300),s(e,t,!1),a(["slide","set","change"])}function u(e,t,n,r){return e=e.replace(/\s/g,N+" ")+N,t.on(e,function(e){var t=x.attr("disabled");return t=!(void 0===t||null===t),x.hasClass(_[14])||t?!1:(e=v(e),e.calcPoint=e.points[i.ort],void n(e,r))})}function h(e,t){var i,n=t.handles||q,r=!1,l=100*(e.calcPoint-t.start)/o(),d=n[0][0]!==q[0][0]?1:0;i=c(l,t.positions,n.length>1),r=s(n[0],i[d],1===n.length),n.length>1&&(r=s(n[1],i[d?0:1],!1)||r),r&&a(["slide"])}function f(t){e("."+_[15]).removeClass(_[15]),t.cursor&&e("body").css("cursor","").off(N),B.off(N),x.removeClass(_[12]),a(["set","change"])}function p(t,i){1===i.handles.length&&i.handles[0].children().addClass(_[15]),t.stopPropagation(),u(z.move,B,h,{start:t.calcPoint,handles:i.handles,positions:[k[0],k[q.length-1]]}),u(z.end,B,f,null),t.cursor&&(e("body").css("cursor",e(t.target).css("cursor")),q.length>1&&x.addClass(_[12]),e("body").on("selectstart"+N,!1))}function b(t){var n,r=t.calcPoint,a=0;t.stopPropagation(),e.each(q,function(){a+=this.offset()[i.style]}),a=a/2>r||1===q.length?0:1,r-=C.offset()[i.style],n=100*r/o(),l(q[a],n,i.events.snap),i.events.snap&&p(t,{handles:[q[a]]})}function I(e){var t=e.calcPoint<C.offset()[i.style],n=t?0:100;t=t?0:q.length-1,l(q[t],n,!1)}function y(e){var t,i;if(!e.fixed)for(t=0;t<q.length;t++)u(z.start,q[t].children(),p,{handles:[q[t]]});e.tap&&u(z.start,C,b,{handles:q}),e.extend&&(x.addClass(_[16]),e.tap&&u(z.start,x,I,{handles:q})),e.drag&&(i=C.find("."+_[7]).addClass(_[10]),e.fixed&&(i=i.add(C.children().not(i).children())),u(z.start,i,p,{handles:q}))}var C,w,q,x=e(t),k=[-1,-1];if(!x.is(":empty"))throw new Error("Slider was already initialized.");C=H(i,x),q=F(i,C),w=O(i,q),P(i.connect,x,q),y(i.events),t.vSet=function(t,n,r,o,c){var l,u;for(i.dir&&i.handles>1&&t.reverse(),c&&d(x,_[14],300),l=0;l<(q.length>1?3:1);l++)u=r||w[l%2][0],u=u.valueOf(t[l%2]),u!==!1&&(u=m(i,u),i.dir&&(u=100-u),s(q[l%2],u,!0)!==!0&&e(w[l%2]).each(function(){this.write(i,k[l%2],q[l%2].children(),x,o)}));return n===!0&&a(["set"]),this},t.vGet=function(){var e,t=[];for(e=0;e<i.handles;e++)t[e]=w[e][0].saved;return 1===t.length?t[0]:i.dir&&i.handles>1?t.reverse():t},t.destroy=function(){return e.each(w,function(){e.each(this,function(){this.target&&this.target.off(N)})}),e(this).off(N).removeClass(_.join(" ")).empty(),r},x.val(i.start)}function L(e){if(this.length){var t=A(e,this);return this.each(function(){j(this,t,e)})}}function G(t){return this.each(function(){var i=e(this).val(),n=this.destroy(),r=e.extend({},n,t);e(this).noUiSlider(r),n.start===r.start&&e(this).val(i)})}var B=e(document),N=".nui",U=e.fn.val,z=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},_=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","noUi-extended","noUi-stacking"],W=["decimals","mark","thousand","prefix","postfix","encoder","decoder","negative","negativeBefore"],$=[2,".","","","",function(e){return e},function(e){return e},"-",""];b.prototype.v=function(e){return this.settings[e]},b.prototype.to=function(e){function t(e){return e.split("").reverse().join("")}e=this.v("encoder")(e);var i="",n="",r="",o="";return 0>e&&(i=this.v("negative"),n=this.v("negativeBefore")),e=Math.abs(e).toFixed(this.v("decimals")).toString(),e=e.split("."),0===parseFloat(e)&&(e[0]="0"),this.v("thousand")?(r=t(e[0]).match(/.{1,3}/g),r=t(r.join(t(this.v("thousand"))))):r=e[0],this.v("mark")&&e.length>1&&(o=this.v("mark")+e[1]),n+this.v("prefix")+i+r+o+this.v("postfix")},b.prototype.from=function(e){function t(e){return e.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g,"\\$&")}var i;return null===e||void 0===e?!1:(e=e.toString(),i=e.replace(new RegExp("^"+t(this.v("negativeBefore"))),""),e!==i?(e=i,i="-"):i="",e=e.replace(new RegExp("^"+t(this.v("prefix"))),""),this.v.negative&&(i="",e=e.replace(new RegExp("^"+t(this.v("negative"))),"-")),e=e.replace(new RegExp(t(this.v("postfix"))+"$"),"").replace(new RegExp(t(this.v("thousand")),"g"),"").replace(this.v("mark"),"."),e=this.v("decoder")(parseFloat(i+e)),isNaN(e)?!1:e)},I.prototype.write=function(e,t,i,n,r){this.update&&r===!1||(t=p(e,t),t=this.format(t),this.saved=t,"function"==typeof this.method?this.method.call(this.target[0]||n[0],t,i,n):this.target[this.method](t,i,n))},I.prototype.format=function(e){return this.formatting.to(e)},I.prototype.valueOf=function(e){return this.formatting.from(e)},e.noUiSlider={Link:I},e.fn.noUiSlider=function(e,t){return(t?G:L).call(this,e)},e.fn.val=function(){var t,i,n,r,o=Array.prototype.slice.call(arguments,0);return o.length?("object"==typeof o[1]?(t=o[1].set,i=o[1].link,n=o[1].update,r=o[1].animate):o[1]===!0&&(t=!0),this.each(function(){e(this).hasClass(_[0])?this.vSet(l(o[0]),t,i,n,r):U.apply(e(this),o)})):this.hasClass(_[0])?this[0].vGet():U.apply(this)}}(window.jQuery||window.Zepto),define("nouislider",function(){}),define("taoQtiItem/qtiCreator/editor/styleEditor/itemResizer",["jquery","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor","nouislider","jqueryui"],function(e,t){"use strict";var i=function(){var i=e("#item-editor-item-resizer"),n=i.data("target"),r=e(n),o=r.width(),a=i.find(".slider-box"),s=i.find("#item-editor-item-resizer-slider"),c=e("#item-editor-item-resizer-text"),l=i.find('[data-role="item-width-reset"]'),d={range:{min:Math.min(768,o),max:Math.max(1200,o)},start:o},u=function(){i.find('[value="no-slider"]').trigger("click")},h=function(e){e=parseInt(e).toString()+"px",t.apply(n,"width",e),t.apply(n,"max-width","none")};i.find('[name="item-width-prompt"]').on("click",function(){"slider"===this.value?(h(r.width()),c.val(r.width()),a.slideDown()):(s.val(d.start),a.slideUp(),c.val(""),t.apply(n,"width"),t.apply(n,"max-width"))}),s.noUiSlider(d),s.on("slide",function(){var e=Math.round(s.val());c.val(e),h(e)}),c.on("keydown",function(e){var t=e.keyCode;return _.contains([8,37,39,46],t)||t>=48&&57>=t||t>=96&&105>=t}),c.on("blur",function(){h(this.value)}),l.on("click",u),e(document).on("customcssloaded.styleeditor",function(e,t){var r;t[n]&&t[n].width&&(r=parseInt(t[n].width,10),c.val(r),s.val(r),i.find('[value="slider"]').trigger("click"))})};return i}),define("taoQtiItem/qtiCreator/editor/styleEditor/styleSheetToggler",["jquery","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor","i18n","ui/resourcemgr"],function(e,t,i){"use strict";var n=function(){var n=function(n){var r=e("#style-sheet-toggler"),o=(e("#stylesheet-uploader"),e("[data-custom-css]")),a=function(t){t=e(t);var i=t.parent(),n=i.data("css-res"),r=i.find(".icon-preview").hasClass("disabled"),o=!!i.data("custom-css");return{icon:t,li:i,cssUri:n,isCustomCss:o,isDisabled:r}};n||r.find("[data-custom-css]").addClass("not-available"),r.find("span.icon-bin").on("click",function(){var n=a(this),r=n.isDisabled?"disabled-href":"href";confirm(i("Are you sure you want to delete this stylesheet?\nWarning: This action cannot be undone!"))&&(t.getItem().remove(),e("link["+r+'$="'+n.cssUri+'"]').remove(),n.li.remove())}),r.find("span.file-label").on("click",function(){var t=e(this),i=t.next(".style-sheet-label-editor");t.hide(),i.show()}),r.find(".style-sheet-label-editor").on("blur",function(){var i=e(this),n=i.prev(".file-label"),r=e.trim(i.val());return r?(t.getItem().attr("title",r),i.hide(),void n.html(r).show()):(t.getItem().attr("title",""),!1)}).on("keydown",function(t){var i=t.keyCode;13===i&&e(this).trigger("blur")}),r.find("span.icon-preview").on("click",function(){var i,n=a(this),r="disabled-href",s="href";n.isCustomCss?n.isDisabled?(t.create(),o.removeClass("not-available")):(t.erase(),o.addClass("not-available")):(n.isDisabled&&(r="href",s="disabled-href"),i=e("link["+s+'$="'+n.cssUri+'"]'),i.attr(r,i.attr(s)).removeAttr(s)),n.icon.toggleClass("disabled")})};return{init:n}}();return n}),define("taoQtiItem/controller/creator/main",["taoQtiItem/qtiCreator/editor/preview","taoQtiItem/qtiCreator/editor/preparePrint","taoQtiItem/qtiCreator/editor/toggleAppearance","taoQtiItem/qtiCreator/editor/listStyler","taoQtiItem/qtiCreator/helper/itemLoader","taoQtiItem/qtiCreator/helper/creatorRenderer","taoQtiItem/qtiCreator/editor/styleEditor/fontSelector","taoQtiItem/qtiCreator/editor/styleEditor/colorSelector","taoQtiItem/qtiCreator/editor/styleEditor/fontSizeChanger","taoQtiItem/qtiCreator/editor/styleEditor/itemResizer","taoQtiItem/qtiCreator/editor/styleEditor/styleEditor","taoQtiItem/qtiCreator/editor/styleEditor/styleSheetToggler"],function(e,t,i,n,r,o,a,s,c,l,d,u){var h=function(r,o){d.init(r,o),u.init(),a(),s(o),c(o),l(o),e.init("#preview-trigger"),t(),i(),n(),$("#item-editor-panel").addClass("has-item"),$(".item-editor-sidebar").fadeTo(2e3,1)},f=function(){{var e=$("#item-editor-interaction-property-bar").hide(),t=$("#item-editor-choice-property-bar").hide(),i=$("#item-editor-response-property-bar").hide();$("#item-editor-body-element-property-bar").hide()}$(document).on("afterStateInit.qti-widget",function(n,r,o){switch(o.name){case"question":e.show();break;case"choice":t.show();break;case"answer":i.show()}}),$(document).on("beforeStateExit.qti-widget",function(n,r,o){switch(o.name){case"question":e.hide();break;case"choice":t.hide();break;case"answer":i.hide()}})};return{start:function(e){f(),r.loadItem({uri:e.uri},function(t){o.setOption("baseUrl",e.baseUrl),o.get().load(function(){t.setRenderer(this),$("#item-editor-panel").append(t.render()),t.postRender({uri:e.uri}),h(t,e)},t.getUsedClasses())})}}});